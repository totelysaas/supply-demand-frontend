(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{30868:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>tQ});var a=s(95155),r=s(12115),n=s(32467),l=s(83101),i=s(2821),o=s(75889);function c(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.QP)((0,i.$)(t))}let d=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function m(e){let{className:t,variant:s,size:r,asChild:l=!1,...i}=e,o=l?n.DX:"button";return(0,a.jsx)(o,{"data-slot":"button",className:c(d({variant:s,size:r,className:t})),...i})}var u=s(95736);function x(e){let{...t}=e;return(0,a.jsx)(u.bL,{"data-slot":"dropdown-menu",...t})}function h(e){let{...t}=e;return(0,a.jsx)(u.l9,{"data-slot":"dropdown-menu-trigger",...t})}function p(e){let{className:t,sideOffset:s=4,...r}=e;return(0,a.jsx)(u.ZL,{children:(0,a.jsx)(u.UC,{"data-slot":"dropdown-menu-content",sideOffset:s,className:c("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...r})})}function f(e){let{className:t,inset:s,variant:r="default",...n}=e;return(0,a.jsx)(u.q7,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":r,className:c("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n})}function g(e){let{className:t,inset:s,...r}=e;return(0,a.jsx)(u.JU,{"data-slot":"dropdown-menu-label","data-inset":s,className:c("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",t),...r})}function j(e){let{className:t,...s}=e;return(0,a.jsx)(u.wv,{"data-slot":"dropdown-menu-separator",className:c("bg-border -mx-1 my-1 h-px",t),...s})}var v=s(89511),y=s(65229);function N(e){let{...t}=e;return(0,a.jsx)(v.bL,{"data-slot":"dialog",...t})}function b(e){let{...t}=e;return(0,a.jsx)(v.l9,{"data-slot":"dialog-trigger",...t})}function w(e){let{...t}=e;return(0,a.jsx)(v.ZL,{"data-slot":"dialog-portal",...t})}function k(e){let{className:t,...s}=e;return(0,a.jsx)(v.hJ,{"data-slot":"dialog-overlay",className:c("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function S(e){let{className:t,children:s,showCloseButton:r=!0,...n}=e;return(0,a.jsxs)(w,{"data-slot":"dialog-portal",children:[(0,a.jsx)(k,{}),(0,a.jsxs)(v.UC,{"data-slot":"dialog-content",className:c("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[s,r&&(0,a.jsxs)(v.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(y.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function C(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:c("flex flex-col gap-2 text-center sm:text-left",t),...s})}function A(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:c("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function _(e){let{className:t,...s}=e;return(0,a.jsx)(v.hE,{"data-slot":"dialog-title",className:c("text-lg leading-none font-semibold",t),...s})}function I(e){let{className:t,...s}=e;return(0,a.jsx)(v.VY,{"data-slot":"dialog-description",className:c("text-muted-foreground text-sm",t),...s})}var z=s(98229),F=s(24033),D=s(5917),M=s(12108);function E(e){let{...t}=e;return(0,a.jsx)(z.bL,{"data-slot":"select",...t})}function L(e){let{...t}=e;return(0,a.jsx)(z.WT,{"data-slot":"select-value",...t})}function T(e){let{className:t,size:s="default",children:r,...n}=e;return(0,a.jsxs)(z.l9,{"data-slot":"select-trigger","data-size":s,className:c("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[r,(0,a.jsx)(z.In,{asChild:!0,children:(0,a.jsx)(F.A,{className:"size-4 opacity-50"})})]})}function U(e){let{className:t,children:s,position:r="popper",...n}=e;return(0,a.jsx)(z.ZL,{children:(0,a.jsxs)(z.UC,{"data-slot":"select-content",className:c("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,a.jsx)(R,{}),(0,a.jsx)(z.LM,{className:c("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(O,{})]})})}function P(e){let{className:t,children:s,...r}=e;return(0,a.jsxs)(z.q7,{"data-slot":"select-item",className:c("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(z.VF,{children:(0,a.jsx)(D.A,{className:"size-4"})})}),(0,a.jsx)(z.p4,{children:s})]})}function R(e){let{className:t,...s}=e;return(0,a.jsx)(z.PP,{"data-slot":"select-scroll-up-button",className:c("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(M.A,{className:"size-4"})})}function O(e){let{className:t,...s}=e;return(0,a.jsx)(z.wn,{"data-slot":"select-scroll-down-button",className:c("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(F.A,{className:"size-4"})})}var B=s(7870);function V(e){let{className:t,...s}=e;return(0,a.jsx)(B.bL,{"data-slot":"avatar",className:c("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...s})}function H(e){let{className:t,...s}=e;return(0,a.jsx)(B.H4,{"data-slot":"avatar-fallback",className:c("bg-muted flex size-full items-center justify-center rounded-full",t),...s})}let W=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:c("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r})});W.displayName="Textarea";let q=(0,l.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function X(e){let{className:t,variant:s,asChild:r=!1,...l}=e,i=r?n.DX:"span";return(0,a.jsx)(i,{"data-slot":"badge",className:c(q({variant:s}),t),...l})}var K=s(38162);function Z(e){let{className:t,...s}=e;return(0,a.jsx)(K.bL,{"data-slot":"checkbox",className:c("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:(0,a.jsx)(K.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,a.jsx)(D.A,{className:"size-3.5"})})})}var Y=s(10489);function $(e){let{className:t,...s}=e;return(0,a.jsx)(Y.b,{"data-slot":"label",className:c("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}var G=s(6191),J=s(20017),Q=s(95740),ee=s(21786),et=s(39867),es=s(61362),ea=s(35299),er=s(26983),en=s(85921),el=s(20508),ei=s(19408),eo=s(84926),ec=s(37494),ed=s(59427);function em(){let[e,t]=(0,r.useState)("dark");return(0,r.useEffect)(()=>{let e=document.documentElement,s=localStorage.getItem("theme")||"dark";t(s),e.classList.toggle("dark","dark"===s)},[]),(0,a.jsx)(m,{variant:"ghost",size:"icon",onClick:()=>{let s="light"===e?"dark":"light";t(s),document.documentElement.classList.toggle("dark","dark"===s),localStorage.setItem("theme",s)},className:"h-9 w-9",children:"light"===e?(0,a.jsx)(ec.A,{className:"h-4 w-4"}):(0,a.jsx)(ed.A,{className:"h-4 w-4"})})}let eu=(0,r.createContext)(void 0);function ex(e){let{children:t}=e,[s,n]=(0,r.useState)("USD");return(0,r.useEffect)(()=>{let e=localStorage.getItem("currency");e&&["USD","EUR","INR"].includes(e)&&n(e)},[]),(0,a.jsx)(eu.Provider,{value:{currency:s,setCurrency:e=>{n(e),localStorage.setItem("currency",e)},formatCurrency:e=>{let t,a=Math.abs(e);return t=a>=1e6?"".concat((a/1e6).toFixed(1),"M"):a>=1e3?"".concat((a/1e3).toFixed(1),"K"):a.toFixed(0),"".concat(e<0?"-":"").concat("USD"===s?"$":"EUR"===s?"€":"₹").concat(t)}},children:t})}function eh(){let e=(0,r.useContext)(eu);if(void 0===e)throw Error("useCurrency must be used within a CurrencyProvider");return e}function ep(e){let{className:t,type:s,...r}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:c("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}var ef=s(78874);function eg(e){let{open:t,onOpenChange:s,onUploadComplete:n}=e,[l,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),[x,h]=(0,r.useState)([]),[p,f]=(0,r.useState)(null),[g,j]=(0,r.useState)(!1),v=async()=>{if(!l.trim())return void f("Please enter a bucket name");u(!0),f(null),h([]),j(!1),console.log("[v0] Starting S3 upload from modal"),console.log("[v0] Bucket:",l.trim()),console.log("[v0] Folder:",o.trim());try{let e=await uploadFromS3(l.trim(),o.trim());if(console.log("[v0] Server action result:",e),!e.success)throw Error(e.error||"Failed to upload from S3");h(e.files),j(!0),console.log("[v0] Upload successful, files:",e.files.length),n&&n(e.files)}catch(e){console.error("[v0] Upload error:",e),f(e.message||"Failed to upload from S3")}finally{u(!1)}},y=()=>{i(""),c(""),h([]),f(null),j(!1),s(!1)};return(0,a.jsx)(N,{open:t,onOpenChange:y,children:(0,a.jsxs)(S,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(_,{children:"Upload from S3"}),(0,a.jsx)(I,{children:"Enter your S3 bucket name and optional folder path to upload CSV files."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"bucket-name",children:"S3 Bucket Name *"}),(0,a.jsx)(ep,{id:"bucket-name",placeholder:"my-bucket-name",value:l,onChange:e=>i(e.target.value),disabled:d||g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"folder-path",children:"Folder Path (optional)"}),(0,a.jsx)(ep,{id:"folder-path",placeholder:"data/csv-files",value:o,onChange:e=>c(e.target.value),disabled:d||g}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Leave empty to upload from the root of the bucket"})]}),p&&(0,a.jsxs)("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-destructive/10 border border-destructive/20",children:[(0,a.jsx)(ef.A,{className:"h-5 w-5 text-destructive shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-destructive",children:"Upload Failed"}),(0,a.jsx)("p",{className:"text-sm text-destructive/90 mt-1",children:p})]})]}),g&&x.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-foreground",children:[(0,a.jsx)(es.A,{className:"h-5 w-5 text-green-500"}),(0,a.jsxs)("span",{children:["Successfully uploaded ",x.length," file(s)"]})]}),(0,a.jsx)("div",{className:"border border-border rounded-lg divide-y divide-border max-h-[200px] overflow-y-auto",children:x.map((e,t)=>{var s;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-foreground truncate",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(s=e.size)<1024?"".concat(s," B"):s<1048576?"".concat((s/1024).toFixed(1)," KB"):"".concat((s/1048576).toFixed(1)," MB")})]}),(0,a.jsxs)(X,{variant:"outline",className:"ml-2",children:[(0,a.jsx)(es.A,{className:"h-3 w-3 mr-1 text-green-500"}),"Uploaded"]})]},t)})})]})]}),(0,a.jsx)(A,{children:g?(0,a.jsx)(m,{onClick:y,className:"w-full",children:"Done"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m,{variant:"outline",onClick:y,disabled:d,children:"Cancel"}),(0,a.jsx)(m,{onClick:v,disabled:d||!l.trim(),children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ea.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee.A,{className:"h-4 w-4 mr-2"}),"Upload"]})})]})})]})})}var ej=s(9484);function ev(e){let{className:t,value:s,...r}=e;return(0,a.jsx)(ej.bL,{"data-slot":"progress",className:c("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...r,children:(0,a.jsx)(ej.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})}let ey=(0,l.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function eN(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:c(ey({variant:s}),t),...r})}function eb(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:c("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}var ew=s(59034);function ek(e){let{className:t,children:s,...r}=e;return(0,a.jsxs)(ew.bL,{"data-slot":"scroll-area",className:c("relative",t),...r,children:[(0,a.jsx)(ew.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:s}),(0,a.jsx)(eS,{}),(0,a.jsx)(ew.OK,{})]})}function eS(e){let{className:t,orientation:s="vertical",...r}=e;return(0,a.jsx)(ew.VM,{"data-slot":"scroll-area-scrollbar",orientation:s,className:c("flex touch-none p-px transition-colors select-none","vertical"===s&&"h-full w-2.5 border-l border-l-transparent","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent",t),...r,children:(0,a.jsx)(ew.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var eC=s(58734);let eA="http://localhost:8000";async function e_(){try{let e=await fetch("".concat(eA,"/api/s3/folders"));return await e.json()}catch(e){return console.error("[API] Error listing S3 folders:",e),{success:!1,error:e instanceof Error?e.message:"Failed to list folders",folders:[]}}}async function eI(e){try{let t=await fetch("".concat(eA,"/api/s3/data/").concat(encodeURIComponent(e)));return await t.json()}catch(e){return console.error("[API] Error loading data from S3:",e),{success:!1,error:e instanceof Error?e.message:"Failed to load data from S3",files:[]}}}async function ez(e,t){try{let s=new FormData;t.forEach(e=>{s.append("files",e)});let a=await fetch("".concat(eA,"/api/s3/upload/").concat(encodeURIComponent(e)),{method:"POST",body:s});return await a.json()}catch(e){return console.error("[API] Error uploading files to S3:",e),{success:!1,error:e instanceof Error?e.message:"Failed to upload files",uploaded_files:[],errors:[]}}}function eF(e){let{open:t,onOpenChange:s}=e,[n]=(0,r.useState)("supply-demand-inventory-1762030832"),[l,i]=(0,r.useState)(""),[o,c]=(0,r.useState)([]),[d,u]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[p,f]=(0,r.useState)([]),[g,j]=(0,r.useState)([]),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(null),k=async()=>{u(!0);try{let e=await e_();e.success&&(c(e.folders),h(!0))}catch(e){console.error("[v0] Error loading folders:",e)}finally{u(!1)}};(0,r.useEffect)(()=>{t?k():(h(!1),i(""),f([]),j([]),w(null))},[t]);let A=async()=>{if(0===p.length)return void w("Please select at least one file to upload");y(!0),w(null),console.log("[v0] Starting upload of",p.length,"files to folder:",l),j(e=>e.map(e=>({...e,status:"uploading",progress:50})));try{let e=await ez(l,p);e.success?(console.log("[v0] Successfully uploaded all files"),j(e=>e.map(e=>({...e,status:"success",progress:100})))):(console.error("[v0] Upload failed:",e.error),w(e.error||"Upload failed"),j(e=>e.map(e=>({...e,status:"error",progress:0}))))}catch(e){console.error("[v0] Error uploading files:",e),w(e instanceof Error?e.message:"Upload failed"),j(e=>e.map(e=>({...e,status:"error",progress:0})))}y(!1),console.log("[v0] Upload process completed")},z=()=>{v||(f([]),j([]),i(""),w(null),s(!1))},F=g.length>0&&g.every(e=>"pending"!==e.status);return g.some(e=>"error"===e.status),(0,a.jsx)(N,{open:t,onOpenChange:z,children:(0,a.jsxs)(S,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(_,{children:"Upload Files to S3"}),(0,a.jsx)(I,{children:"Upload CSV files to your S3 bucket. You can optionally specify a folder path."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"bucket",children:"S3 Bucket"}),(0,a.jsx)(ep,{id:"bucket",value:n,disabled:!0,className:"bg-muted"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)($,{htmlFor:"folder",children:"Folder Path (Optional)"}),(0,a.jsxs)(m,{type:"button",variant:"outline",size:"sm",onClick:k,disabled:d||v,className:"h-8",children:[d?(0,a.jsx)(ea.A,{className:"h-3 w-3 animate-spin"}):(0,a.jsx)(eC.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"ml-1",children:"Browse"})]})]}),(0,a.jsx)(ep,{id:"folder",placeholder:"e.g., dataset/input",value:l,onChange:e=>i(e.target.value),disabled:v}),x&&o.length>0&&(0,a.jsxs)("div",{className:"border rounded-md",children:[(0,a.jsx)("div",{className:"p-2 text-sm font-medium border-b bg-muted/50",children:"Available Folders:"}),(0,a.jsx)(ek,{className:"h-32",children:(0,a.jsx)("div",{className:"p-1",children:o.map(e=>(0,a.jsxs)(m,{variant:"ghost",size:"sm",className:"w-full justify-start h-8 px-2 text-xs",onClick:()=>{i(e),h(!1)},children:[(0,a.jsx)(eC.A,{className:"h-3 w-3 mr-2"}),e]},e))})})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Leave empty to upload to the root of the bucket. Folder will be created if it doesn't exist."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"files",children:"Select Files"}),(0,a.jsx)(ep,{id:"files",type:"file",multiple:!0,accept:".csv",onChange:e=>{let t=Array.from(e.target.files||[]);f(t),j(t.map(e=>({name:e.name,status:"pending",progress:0,size:(e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]})(e.size)}))),w(null)},disabled:v,className:"cursor-pointer"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Select one or more CSV files to upload"})]}),b&&(0,a.jsxs)(eN,{variant:"destructive",children:[(0,a.jsx)(ef.A,{className:"h-4 w-4"}),(0,a.jsx)(eb,{children:b})]}),g.length>0&&(0,a.jsxs)("div",{className:"space-y-3 max-h-[300px] overflow-y-auto border rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"Upload Progress"}),g.map((e,t)=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:["pending"===e.status&&(0,a.jsx)(ee.A,{className:"h-4 w-4 text-muted-foreground shrink-0"}),"uploading"===e.status&&(0,a.jsx)(ea.A,{className:"h-4 w-4 text-blue-500 animate-spin shrink-0"}),"success"===e.status&&(0,a.jsx)(es.A,{className:"h-4 w-4 text-green-500 shrink-0"}),"error"===e.status&&(0,a.jsx)(ef.A,{className:"h-4 w-4 text-destructive shrink-0"}),(0,a.jsx)("span",{className:"truncate",title:e.name,children:e.name})]}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground ml-2 shrink-0",children:e.size})]}),"uploading"===e.status&&(0,a.jsx)(ev,{value:e.progress,className:"h-1"}),e.error&&(0,a.jsx)("p",{className:"text-xs text-destructive",children:e.error})]},t))]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(m,{variant:"outline",onClick:z,disabled:v,children:F?"Close":"Cancel"}),!F&&(0,a.jsx)(m,{onClick:A,disabled:v||0===p.length,children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ea.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee.A,{className:"mr-2 h-4 w-4"}),"Upload ",p.length>0?"".concat(p.length," file").concat(p.length>1?"s":""):""]})})]})]})})}var eD=s(7496),eM=s.n(eD);function eE(e){let{open:t,onOpenChange:s,onConfirm:n}=e,[l,i]=(0,r.useState)(""),[o,c]=(0,r.useState)([]),[d,u]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),p=async()=>{u(!0);try{let e=await e_();e.success&&(c(e.folders),h(!0))}catch(e){console.error("[v0] Error loading folders:",e)}finally{u(!1)}};(0,r.useEffect)(()=>{t?p():(h(!1),c([]))},[t]);let f=()=>{l.trim()&&(n(l.trim()),i(""))};return(0,a.jsx)(N,{open:t,onOpenChange:s,children:(0,a.jsxs)(S,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(_,{children:"Enable Cloud Mode"}),(0,a.jsx)(I,{children:'Enter the S3 folder name to load data from. The folder should contain your CSV files in the bucket "supply-demand-inventory-1762030832".'})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"folder-name",children:"Folder Name"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(ep,{id:"folder-name",placeholder:"e.g., dataset/input",value:l,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&l.trim()&&f()}}),(0,a.jsx)(m,{variant:"outline",size:"icon",onClick:()=>h(!x),disabled:d,children:d?(0,a.jsx)(ea.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(eC.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:'Leave empty to load from the root of the bucket, or specify a folder path like "dataset/input"'})]}),x&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)($,{children:["Available Folders (",o.length,")"]}),o.length>0?(0,a.jsx)(ek,{className:"h-[200px] rounded-md border p-2",children:(0,a.jsx)("div",{className:"space-y-1",children:o.map(e=>(0,a.jsxs)("button",{onClick:()=>{i(e),h(!1)},className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-accent hover:text-accent-foreground transition-colors",children:[(0,a.jsx)(eC.A,{className:"inline-block h-4 w-4 mr-2"}),e]},e))})}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No folders found in the bucket."})]})]}),(0,a.jsxs)(A,{children:[(0,a.jsx)(m,{variant:"outline",onClick:()=>{i(""),s(!1)},children:"Cancel"}),(0,a.jsx)(m,{onClick:f,disabled:!l.trim(),children:"OK"})]})]})})}var eL=s(23327),eT=s(82286);function eU(e){let{...t}=e;return(0,a.jsx)(eT.bL,{"data-slot":"popover",...t})}function eP(e){let{...t}=e;return(0,a.jsx)(eT.l9,{"data-slot":"popover-trigger",...t})}function eR(e){let{className:t,align:s="center",sideOffset:r=4,...n}=e;return(0,a.jsx)(eT.ZL,{children:(0,a.jsx)(eT.UC,{"data-slot":"popover-content",align:s,sideOffset:r,className:c("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})})}function eO(e){return e.trim().split("\n").map(e=>{let t=[],s="",a=!1;for(let r=0;r<e.length;r++){let n=e[r];'"'===n?a=!a:","!==n||a?s+=n:(t.push(s.trim()),s="")}return t.push(s.trim()),t})}async function eB(e){let t="true"===localStorage.getItem("cloudMode"),s=localStorage.getItem("s3FolderPath");if(console.log("[v0] Loading ".concat(e," - cloudMode:"),t,"s3FolderPath:",s),t&&s){console.log("[v0] Fetching ".concat(e," from S3 folder:"),s);let t=await eI(s);if(!t.success||!t.files)throw console.error("[v0] S3 load failed for ".concat(e,":"),t.error),Error(t.error||"Failed to load from S3");let a=t.files.find(t=>t.name===e);if(!a)throw console.error("[v0] ".concat(e," not found in S3 data")),Error("".concat(e," not found in S3 data"));return console.log("[v0] Successfully loaded ".concat(e," from S3, size:"),a.content.length),a.content}{console.log("[v0] Fetching ".concat(e," from local data"));let t=await fetch("/local_data/".concat(e)),s=await t.text();return console.log("[v0] Successfully loaded ".concat(e," from local, size:"),s.length),s}}async function eV(){try{let e=await eB("metrics.csv");return eO(e).slice(1).map(e=>({metric_id:e[0],metric_name:e[1],unit_value:Number.parseFloat(e[2]),financial_value:Number.parseFloat(e[3])}))}catch(e){return console.error("[v0] Error loading metrics:",e),[]}}async function eH(){try{let e=await eB("measures.csv");return eO(e).slice(1).map(e=>({measure_id:e[0],measure_name:e[1],product_id:e[2],location_id:e[3],weeks:e.slice(4,24).map(e=>Number.parseFloat(e)||0)}))}catch(e){return console.error("[v0] Error loading measures:",e),[]}}async function eW(){try{let e=await eB("products.csv");return eO(e).slice(1).map(e=>({product_family:e[0],product_id:e[1]}))}catch(e){return console.error("[v0] Error loading products:",e),[]}}async function eq(){try{let e=await eB("recommendations.csv");return eO(e).slice(1).map(e=>({id:e[0],source:e[1]||"recommendation",name:e[2],type:e[3],severity:e[4]||"medium",status:e[5]||"open",action_status:e[6],start_date:e[7]||void 0,completion_date:e[8]||void 0,created_date:e[9]||void 0}))}catch(e){return console.error("[v0] Error loading recommendations:",e),[]}}async function eX(){try{let e=await eB("segmentation.csv");return eO(e).slice(1).map(e=>({product_id:e[0],ABC_value:e[1]||"A",XYZ_value:e[2]||"X",on_hand_inventory_unit:Number.parseFloat(e[3])||0,on_hand_inventory_financial:Number.parseFloat(e[4])||0,target_inventory_unit:Number.parseFloat(e[5])||0,target_inventory_financial:Number.parseFloat(e[6])||0,on_hand_inventory_days:Number.parseFloat(e[7])||0,target_inventory_days:Number.parseFloat(e[8])||0}))}catch(e){return console.error("[v0] Error loading segmentation:",e),[]}}async function eK(){try{let e=await eB("recommendations_mapping.csv");return eO(e).slice(1).map(e=>({recommendation_id:e[0],display_name:e[1]}))}catch(e){return console.error("[v0] Error loading recommendation mappings:",e),[]}}function eZ(e){return Array.isArray(e)?[...new Set(e.map(e=>e.product_family))].sort():[]}let eY=(0,r.createContext)(void 0);function e$(e){let{children:t}=e,[s,n]=(0,r.useState)([]),[l,i]=(0,r.useState)([]),[o,c]=(0,r.useState)([]),[d,m]=(0,r.useState)([]),[u,x]=(0,r.useState)([]),[h,p]=(0,r.useState)([]),[f,g]=(0,r.useState)(!0),[j,v]=(0,r.useState)(null),[y,N]=(0,r.useState)(null),[b,w]=(0,r.useState)(null),k=()=>{let e=localStorage.getItem("recommendationUpdates");return e?JSON.parse(e):{}},S=async()=>{try{g(!0),v(null);let e="true"===localStorage.getItem("cloudMode"),t=localStorage.getItem("s3FolderPath"),[s,a,r,l,o,d]=await Promise.all([eV(),eH(),eW(),eq(),eX(),eK()]);n(s),i(a),c(r);let u=k(),h=l.map(e=>u[e.id]?{...e,...u[e.id]}:e);m(h),x(o),p(d),v(null),N(new Date),w(e&&t?{type:"s3",bucket:"supply-demand-inventory-1762030832",folder:t}:{type:"local"})}catch(t){console.error("[v0] Error loading data:",t);let e=t instanceof Error?t.message:"Failed to load data";v(e),setTimeout(()=>{alert("Error loading data: ".concat(e))},100)}finally{g(!1)}};return(0,r.useEffect)(()=>{S();let e=e=>{"cloudMode"===e.key&&(console.log("[v0] Cloud mode changed, reloading data"),S())},t=()=>{console.log("[v0] Custom data reload event received"),S()};return window.addEventListener("storage",e),window.addEventListener("reloadData",t),()=>{window.removeEventListener("storage",e),window.removeEventListener("reloadData",t)}},[]),(0,a.jsx)(eY.Provider,{value:{metrics:s,measures:l,products:o,recommendations:d,segmentation:u,recommendationMappings:h,loading:f,error:j,lastUpdated:y,dataSource:b,reloadData:S,updateRecommendation:e=>{m(t=>t.map(t=>t.id===e.id?e:t));var t=e.id;let s=k();s[t]={...s[t],...e},localStorage.setItem("recommendationUpdates",JSON.stringify(s))}},children:t})}function eG(){let e=(0,r.useContext)(eY);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}var eJ=s(27830);function eQ(){let{lastUpdated:e,dataSource:t}=eG();if(!e||!t)return null;let s=(0,eJ.m)(e,{addSuffix:!0});return(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{className:"hidden sm:inline",children:["Updated ",s]}),(0,a.jsxs)(eU,{children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsx)("button",{className:"hover:text-foreground transition-colors",children:(0,a.jsx)(eL.A,{className:"h-3.5 w-3.5"})})}),(0,a.jsx)(eR,{className:"w-80",align:"start",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm",children:"Data Source Information"}),(0,a.jsxs)("div",{className:"space-y-1.5 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Last Updated:"}),(0,a.jsx)("span",{className:"font-medium",children:e.toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Source Type:"}),(0,a.jsx)("span",{className:"font-medium capitalize",children:"s3"===t.type?"Cloud (S3)":"Local Files"})]}),"s3"===t.type&&t.bucket&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"S3 Bucket:"}),(0,a.jsx)("span",{className:"font-mono text-xs",children:t.bucket})]}),t.folder&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Folder:"}),(0,a.jsx)("span",{className:"font-mono text-xs",children:t.folder})]})]})]})]})})]})]})}function e0(){let[e]=(0,r.useState)({name:"Sarah Chen",company:"Acme Electronics",initials:"SC"}),[t,s]=(0,r.useState)("live"),[n,l]=(0,r.useState)(!1),[i,o]=(0,r.useState)({supplyLeadTime:!1,inventoryPolicy:!1,shipmentDelays:!1,scheduledShipmentDelays:!1}),[c,d]=(0,r.useState)(""),[u,v]=(0,r.useState)({timestamp:"2 hours ago",status:"completed",duration:"3.2s"}),[y]=(0,r.useState)([{name:"ABC, XYZ Segmentation",status:"completed"},{name:"resolve shortage",status:"completed"},{name:"generate recommendations",status:"completed"}]),[b,w]=(0,r.useState)([{id:"1",type:"inventory-deficit",partName:"Widget A",quantity:500},{id:"2",type:"inventory-excess",partName:"Component B",quantity:200},{id:"3",type:"purchase-order",partName:"Material C",quantity:1e3,supplier:"Supplier X"},{id:"4",type:"purchase-order",partName:"Widget A",quantity:500,supplier:"ABC Manufacturing"},{id:"5",type:"inventory-deficit",partName:"Bolt M8",quantity:2e3}]),[k,z]=(0,r.useState)([]),[F,D]=(0,r.useState)(null),[M,R]=(0,r.useState)(""),{currency:O,setCurrency:B}=eh(),[q,K]=(0,r.useState)(!1),[Y,ec]=(0,r.useState)(O),[ed,eu]=(0,r.useState)(!1),[ex,ep]=(0,r.useState)(!1),[ef,ej]=(0,r.useState)(!1),[ev,ey]=(0,r.useState)(!1),[eN,eb]=(0,r.useState)(!1),[ew,ek]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=localStorage.getItem("cloudMode");null!==e&&eu("true"===e)},[]);let eS=async e=>{ey(!1),eb(!0);try{console.log("[v0] Loading data from S3 folder:",e);let t=await eI(e);t.success&&t.files?(localStorage.removeItem("s3Data"),localStorage.setItem("s3FolderPath",e),localStorage.setItem("cloudMode","true"),eu(!0),console.log("[v0] Cloud mode enabled, triggering reload"),window.dispatchEvent(new Event("reloadData"))):(console.error("[v0] Failed to load from S3:",t.error),alert("Failed to load data from S3: ".concat(t.error)))}catch(e){console.error("[v0] Error loading from S3:",e),alert("Failed to load data from S3. Please check your credentials and folder path.")}finally{eb(!1)}},eC=e=>{o(t=>({...t,[e]:!t[e]}))},eA=async()=>{ek(!0);try{let e=new(eM());for(let t of["measures.csv","metrics.csv","products.csv","recommendations.csv","recommendations_mapping.csv","segmentation.csv"])try{let s=await fetch("/local_data/".concat(t));if(s.ok){let a=await s.text();e.file(t,a),console.log("[v0] Added ".concat(t," to zip"))}else console.error("[v0] Failed to fetch ".concat(t,":"),s.statusText)}catch(e){console.error("[v0] Error fetching ".concat(t,":"),e)}let t=await e.generateAsync({type:"blob"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="trelliso-sample-dataset.zip",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),console.log("[v0] Sample dataset downloaded successfully")}catch(e){console.error("[v0] Error creating zip file:",e)}finally{ek(!1)}},e_=Object.values(i).some(e=>e);return b.filter(e=>"inventory-deficit"===e.type||"inventory-excess"===e.type),b.filter(e=>"purchase-order"===e.type),(0,a.jsxs)("header",{className:"sticky top-0 z-50 border-b border-border bg-card",children:[(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded-lg bg-primary flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-primary-foreground font-bold text-sm",children:"T"})}),(0,a.jsx)("h1",{className:"text-xl font-semibold text-foreground",children:"Trelliso AI"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,a.jsxs)(E,{value:t,onValueChange:e=>{"new-scenario"===e?(l(!0),o({supplyLeadTime:!1,inventoryPolicy:!1,shipmentDelays:!1,scheduledShipmentDelays:!1})):s(e)},children:[(0,a.jsx)(T,{className:"w-[160px] h-8",children:(0,a.jsx)(L,{})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"live",children:"Live"}),(0,a.jsx)(P,{value:"new-scenario",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),"New Scenario"]})})]})]}),(0,a.jsxs)(x,{children:[(0,a.jsx)(h,{asChild:!0,children:(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(p,{align:"start",children:[(0,a.jsx)(g,{children:"Data Actions"}),(0,a.jsx)(j,{}),(0,a.jsx)(f,{onClick:()=>{ed?(eu(!1),localStorage.setItem("cloudMode","false"),localStorage.removeItem("s3Data"),localStorage.removeItem("s3FolderPath"),window.dispatchEvent(new Event("reloadData"))):ey(!0)},onSelect:e=>e.preventDefault(),children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Q.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Cloud Mode"})]}),(0,a.jsx)(X,{variant:ed?"default":"secondary",className:"text-xs ml-2",children:ed?"On":"Off"})]})}),(0,a.jsx)(j,{}),(0,a.jsxs)(f,{onClick:()=>ej(!0),children:[(0,a.jsx)(ee.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Upload to S3"})]}),(0,a.jsxs)(f,{onClick:eA,disabled:ew,children:[(0,a.jsx)(et.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:ew?"Downloading...":"Download Sample Dataset"})]})]})]}),(0,a.jsx)(eQ,{})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(em,{}),(0,a.jsxs)(x,{children:[(0,a.jsx)(h,{asChild:!0,children:(0,a.jsxs)(m,{variant:"default",className:"gap-2",children:[(0,a.jsx)(Q.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Agent"})]})}),(0,a.jsxs)(p,{align:"end",className:"w-[420px] max-h-[600px] overflow-y-auto",children:[(0,a.jsx)(g,{children:"Supply Demand Agent"}),(0,a.jsx)(j,{}),(0,a.jsxs)("div",{className:"px-2 py-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Last Run:"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:u.timestamp})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status:"}),(0,a.jsx)("span",{className:"text-foreground font-medium capitalize",children:u.status})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Duration:"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:u.duration})]})]}),(0,a.jsx)(j,{}),(0,a.jsxs)("div",{className:"px-2 py-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-foreground mb-2",children:"Tools Called"}),(0,a.jsx)("div",{className:"space-y-2",children:y.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:["completed"===e.status&&(0,a.jsx)(es.A,{className:"h-4 w-4 text-green-500"}),"running"===e.status&&(0,a.jsx)(ea.A,{className:"h-4 w-4 text-blue-500 animate-spin"}),"pending"===e.status&&(0,a.jsx)(er.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-foreground",children:e.name})]},t))}),(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Recommendations Generated:"}),(0,a.jsxs)("button",{onClick:()=>{let e=document.getElementById("recommendations-section");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},className:"text-primary hover:underline font-medium",children:[b.length+k.length," recommendations"]})]})})]}),(0,a.jsx)(j,{}),k.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"px-2 py-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-foreground mb-3",children:"Actions"}),(0,a.jsx)("div",{className:"space-y-2",children:k.map(e=>(0,a.jsxs)("div",{className:"border border-border rounded-lg p-2 space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-foreground font-medium",children:"purchase-order"===e.type?"".concat(e.partName," - ").concat(e.quantity," units from ").concat(e.supplier):"".concat(e.partName," - ").concat(e.quantity," units")}),e.reason&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Reason: ",e.reason]})]}),(0,a.jsx)(X,{variant:(e=>{switch(e){case"accepted":return"default";case"rejected":return"destructive"}})(e.action),className:"text-xs capitalize shrink-0",children:e.action})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(X,{variant:"outline",className:"text-xs",children:(e=>{switch(e){case"inventory-deficit":return"Deficit";case"inventory-excess":return"Excess";case"purchase-order":return"Purchase Order"}})(e.type)}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.timestamp})]})]},e.id))})]}),(0,a.jsx)(j,{})]}),(0,a.jsxs)("div",{className:"px-2 py-2 space-y-2",children:[(0,a.jsx)(W,{placeholder:"Analyze current plan or various what-if scenarios such as shipment delays, supplier lead time change, inventory policy change and more.",value:c,onChange:e=>d(e.target.value),className:"min-h-[80px] resize-none text-sm"}),(0,a.jsxs)(m,{onClick:()=>{console.log("[v0] Running agent with message:",c)},disabled:!c.trim(),className:"w-full gap-2",size:"sm",children:[(0,a.jsx)(en.A,{className:"h-4 w-4"}),"Run Agent"]})]})]})]}),(0,a.jsxs)(x,{children:[(0,a.jsx)(h,{asChild:!0,children:(0,a.jsxs)(m,{variant:"ghost",className:"gap-2 hover:bg-transparent hover:text-foreground border-0 focus-visible:ring-0",children:[(0,a.jsx)(V,{className:"h-8 w-8",children:(0,a.jsx)(H,{className:"bg-primary text-primary-foreground text-sm",children:e.initials})}),(0,a.jsx)("span",{className:"text-sm font-medium hidden md:inline",children:e.name})]})}),(0,a.jsxs)(p,{align:"end",className:"w-56",children:[(0,a.jsx)(g,{className:"font-normal",children:(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-foreground",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.company})]})}),(0,a.jsx)(j,{}),(0,a.jsxs)(f,{children:[(0,a.jsx)(el.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Profile"})]}),(0,a.jsxs)(f,{onClick:()=>{ec(O),K(!0)},children:[(0,a.jsx)(ei.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Company Settings"})]}),(0,a.jsx)(j,{}),(0,a.jsxs)(f,{className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Log out"})]})]})]})]})]})}),(0,a.jsx)(N,{open:n,onOpenChange:l,children:(0,a.jsxs)(S,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(_,{children:"Create New Scenario"}),(0,a.jsx)(I,{children:"Select the parameters you want to analyze in this what-if scenario."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"supply-lead-time",checked:i.supplyLeadTime,onCheckedChange:()=>eC("supplyLeadTime")}),(0,a.jsx)($,{htmlFor:"supply-lead-time",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Supply lead time changes"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"inventory-policy",checked:i.inventoryPolicy,onCheckedChange:()=>eC("inventoryPolicy")}),(0,a.jsx)($,{htmlFor:"inventory-policy",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Inventory policy changes"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"shipment-delays",checked:i.shipmentDelays,onCheckedChange:()=>eC("shipmentDelays")}),(0,a.jsx)($,{htmlFor:"shipment-delays",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Shipment delays"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"scheduled-shipment-delays",checked:i.scheduledShipmentDelays,onCheckedChange:()=>eC("scheduledShipmentDelays")}),(0,a.jsx)($,{htmlFor:"scheduled-shipment-delays",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Scheduled shipment delays"})]})]}),(0,a.jsxs)(A,{children:[(0,a.jsx)(m,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),(0,a.jsxs)(m,{onClick:()=>{console.log("[v0] Running scenario with options:",i),l(!1)},disabled:!e_,children:[(0,a.jsx)(en.A,{className:"h-4 w-4 mr-2"}),"Run"]})]})]})}),(0,a.jsx)(N,{open:q,onOpenChange:K,children:(0,a.jsxs)(S,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(_,{children:"Company Settings"}),(0,a.jsx)(I,{children:"Configure your company preferences and display settings."})]}),(0,a.jsx)("div",{className:"space-y-4 py-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"currency",className:"text-sm font-medium",children:"Currency"}),(0,a.jsxs)(E,{value:Y,onValueChange:e=>ec(e),children:[(0,a.jsx)(T,{id:"currency",children:(0,a.jsx)(L,{})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"USD",children:"$ USD (US Dollar)"}),(0,a.jsx)(P,{value:"EUR",children:"€ EUR (Euro)"}),(0,a.jsx)(P,{value:"INR",children:"₹ INR (Indian Rupee)"})]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"This will update all currency displays across the dashboard."})]})}),(0,a.jsxs)(A,{children:[(0,a.jsx)(m,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),(0,a.jsx)(m,{onClick:()=>{B(Y),K(!1)},children:"Save Changes"})]})]})}),(0,a.jsx)(eE,{open:ev,onOpenChange:ey,onConfirm:eS}),eN&&(0,a.jsx)("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-card p-6 rounded-lg shadow-lg flex flex-col items-center gap-4",children:[(0,a.jsx)(ea.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading data from S3..."})]})}),(0,a.jsx)(eg,{open:ex,onOpenChange:ep,onUploadComplete:e=>{console.log("[v0] S3 files uploaded:",e),window.dispatchEvent(new Event("storage"))}}),(0,a.jsx)(eF,{open:ef,onOpenChange:ej})]})}function e1(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:c("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function e2(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:c("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function e4(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:c("leading-none font-semibold",t),...s})}function e5(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:c("px-6",t),...s})}var e3=s(41808),e8=s(86651);function e6(e){let{className:t,...s}=e;return(0,a.jsx)(e3.uB,{"data-slot":"command",className:c("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",t),...s})}function e9(e){let{className:t,...s}=e;return(0,a.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,a.jsx)(e8.A,{className:"size-4 shrink-0 opacity-50"}),(0,a.jsx)(e3.uB.Input,{"data-slot":"command-input",className:c("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",t),...s})]})}function e7(e){let{className:t,...s}=e;return(0,a.jsx)(e3.uB.List,{"data-slot":"command-list",className:c("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",t),...s})}function te(e){let{...t}=e;return(0,a.jsx)(e3.uB.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function tt(e){let{className:t,...s}=e;return(0,a.jsx)(e3.uB.Group,{"data-slot":"command-group",className:c("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",t),...s})}function ts(e){let{className:t,...s}=e;return(0,a.jsx)(e3.uB.Item,{"data-slot":"command-item",className:c("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}var ta=s(26617),tr=s(74054),tn=s(1524),tl=s(26921),ti=s(46398),to=s(46994),tc=s(92056),td=s(73904),tm=s(89559),tu=s(91761),tx=s(52056),th=s(42529);let tp={demand:ta.A,supply:ti.A,inventory:to.A,fillrate:tn.A,excess:tc.A,deficit:td.A,replenishment:tm.A,revenue:tu.A,leadtime:er.A,stockouts:tx.A,ontime:th.A,turns:tm.A};function tf(e){var t,s;let{selectedSegment:n,filters:l,setFilters:i}=e,[o,d]=(0,r.useState)(["demand","inventory","stockouts","excess"]),[u,x]=(0,r.useState)(!1),[h,p]=(0,r.useState)("units"),[f,g]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),[N,b]=(0,r.useState)(""),{formatCurrency:w,currency:k}=eh(),{metrics:S,products:C,measures:A,loading:_}=eG(),I=(0,r.useMemo)(()=>{let e=eZ(C),t=[];return t.push({value:"All Products",label:"All Products",type:"family"}),e.slice(1).forEach(e=>{t.push({value:e.toLowerCase().replace(/\s+/g,"-"),label:e,type:"family"})}),C.forEach(e=>{t.push({value:"product-".concat(e.product_id),label:e.product_id,type:"product"})}),t},[C]),z=(0,r.useMemo)(()=>{if(!N.trim())return I.filter(e=>"family"===e.type);let e=N.toLowerCase();return I.filter(t=>t.label.toLowerCase().includes(e))},[I,N]),F=[{value:"All Locations",label:"All Locations"},...Array.from(new Set(A.map(e=>e.location_id))).sort().map(e=>({value:e,label:e}))];(0,r.useEffect)(()=>{n?d(["inventory","excess","deficit","replenishment"]):d(["demand","inventory","stockouts","excess"])},[n]);let M=S.map(e=>({id:e.metric_id,title:e.metric_name,value:"units"===h?e.unit_value:e.financial_value,icon:tp[e.metric_id]||ta.A,description:e.metric_name})),R=o.map(e=>(e=>{var t,s;let a=S.find(t=>t.metric_id===e);if(!a)return null;let r=tp[e]||ta.A,n="units"===h?a.unit_value:a.financial_value,l=.9*n,i=(n-l)/l*100;return{id:e,title:a.metric_name,value:(t=e,s=n,"fillrate"===t||"ontime"===t?"".concat(s.toFixed(1),"%"):"leadtime"===t?"".concat(s.toFixed(1),"d"):"turns"===t?"".concat(s.toFixed(1),"x"):"$"===h?w(s):s>=1e6?"".concat((s/1e6).toFixed(1),"M"):s>=1e3?"".concat((s/1e3).toFixed(0),"K"):s.toString()),icon:r,change:i>=0?"+".concat(i.toFixed(1),"%"):"".concat(i.toFixed(1),"%"),trend:i>=0?"up":"down",description:a.metric_name}})(e)).filter(Boolean),O=M.filter(e=>!o.includes(e.id));return _?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Key Metrics"})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,a.jsx)(e1,{className:"bg-card border-border",children:(0,a.jsx)(e5,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-24"}),(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-32"}),(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-20"})]})})},e))})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Key Metrics"}),(0,a.jsxs)(eU,{open:f,onOpenChange:g,children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsxs)(m,{variant:"outline",role:"combobox","aria-expanded":f,className:"w-[180px] justify-between h-9 bg-transparent",children:[(null==(t=I.find(e=>e.value===l.product))?void 0:t.label)||"Select product...",(0,a.jsx)(tr.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(eR,{className:"w-[180px] p-0",children:(0,a.jsxs)(e6,{children:[(0,a.jsx)(e9,{placeholder:"Search product...",value:N,onValueChange:b}),(0,a.jsxs)(e7,{children:[(0,a.jsx)(te,{children:"No product found."}),(0,a.jsx)(tt,{children:z.map(e=>(0,a.jsxs)(ts,{value:e.value,onSelect:e=>{i({...l,product:e}),g(!1),b("")},className:"product"===e.type?"text-sm":"font-medium",children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4 ".concat(l.product===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})]})})]}),(0,a.jsxs)(eU,{open:j,onOpenChange:v,children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsxs)(m,{variant:"outline",role:"combobox","aria-expanded":j,className:"w-[180px] justify-between h-9 bg-transparent",children:[(null==(s=F.find(e=>e.value===l.location))?void 0:s.label)||"Select location...",(0,a.jsx)(tr.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(eR,{className:"w-[180px] p-0",children:(0,a.jsxs)(e6,{children:[(0,a.jsx)(e9,{placeholder:"Search location..."}),(0,a.jsxs)(e7,{children:[(0,a.jsx)(te,{children:"No location found."}),(0,a.jsx)(tt,{children:F.map(e=>(0,a.jsxs)(ts,{value:e.value,onSelect:e=>{i({...l,location:e}),v(!1)},children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4 ".concat(l.location===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})]})})]}),(0,a.jsxs)(E,{value:h,onValueChange:e=>p(e),children:[(0,a.jsx)(T,{className:"w-[100px] h-9",children:(0,a.jsx)(L,{})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"units",children:"Units"}),(0,a.jsx)(P,{value:"$",children:"USD"===k?"$":"EUR"===k?"€":"₹"})]})]})]}),O.length>0&&(0,a.jsxs)(eU,{open:u,onOpenChange:x,children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsxs)(m,{variant:"outline",size:"sm",className:"gap-2 bg-transparent",children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),"Add Metric"]})}),(0,a.jsx)(eR,{className:"w-64 p-2",align:"end",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground px-2 py-1",children:"Available Metrics"}),O.map(e=>{let t=e.icon;return(0,a.jsxs)(m,{variant:"ghost",className:"w-full justify-start gap-2 h-auto py-2",onClick:()=>{d([...o,e.id]),x(!1)},children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded-lg bg-primary/10 flex items-center justify-center shrink-0",children:(0,a.jsx)(t,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{className:"flex flex-col items-start",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.title}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id)})]})})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:R.map(e=>{let t=e.icon,s="up"===e.trend;return(0,a.jsxs)(e1,{className:"bg-card border-border hover:border-primary/50 transition-colors relative group",children:[(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{var t;return t=e.id,void d(o.filter(e=>e!==t))},children:(0,a.jsx)(y.A,{className:"h-3 w-3"})}),(0,a.jsxs)(e5,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-3xl font-bold text-foreground mb-1",children:e.value})]}),(0,a.jsx)("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(t,{className:"h-5 w-5 text-primary"})})]}),(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-1",children:[s?(0,a.jsx)(tn.A,{className:"h-4 w-4 text-chart-4"}):(0,a.jsx)(tl.A,{className:"h-4 w-4 text-destructive"}),(0,a.jsx)("span",{className:c("text-sm font-medium",s?"text-chart-4":"text-destructive"),children:e.change}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"vs last period"})]})]})]},e.id)})})]})}var tg=s(15870),tj=s(80534),tv=s(41669),ty=s(15530),tN=s(21190),tb=s(26265),tw=s(59801),tk=s(68425),tS=s(47734),tC=s(73697),tA=s(77033),t_=s(50813),tI=s(54332);function tz(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:c("w-full caption-bottom text-sm",t),...s})})}function tF(e){let{className:t,...s}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:c("[&_tr]:border-b",t),...s})}function tD(e){let{className:t,...s}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:c("[&_tr:last-child]:border-0",t),...s})}function tM(e){let{className:t,...s}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:c("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function tE(e){let{className:t,...s}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:c("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function tL(e){let{className:t,...s}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:c("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}var tT=s(90368),tU=s(27937);function tP(e){let{open:t,onOpenChange:s,segment:n,totalItems:l}=e,[i,o]=(0,r.useState)(""),[c,d]=(0,r.useState)(1),u=(0,r.useMemo)(()=>n?((e,t)=>{let s=[],a=["Warehouse A","Warehouse B","Warehouse C","Distribution Center 1","Distribution Center 2"],[r,n]=e.split("");for(let l=0;l<t;l++){let t=Math.random()>.6,i=!t&&Math.random()>.7,o=Math.floor(500*Math.random())+100,c=Math.floor(1e3*Math.random())+50,d=t?Math.floor(200*Math.random())+50:0,m=i?Math.floor(150*Math.random())+30:0,u=i?m+o:Math.floor(300*Math.random());s.push({id:"PART-".concat(e,"-").concat(String(l+1).padStart(5,"0")),partNumber:"".concat(e,"-").concat(Math.random().toString(36).substring(2,8).toUpperCase()),location:a[Math.floor(Math.random()*a.length)],abc:r,xyz:n,safetyStockQty:o,safetyStockWeeks:(o/(c/4)).toFixed(1),currentInventory:c,excessAmount:d,stockoutAmount:m,replenishmentAmount:u})}return s})(n,l):[],[n,l]),x=(0,r.useMemo)(()=>{if(!i)return u;let e=i.toLowerCase();return u.filter(t=>t.partNumber.toLowerCase().includes(e)||t.location.toLowerCase().includes(e)||t.id.toLowerCase().includes(e))},[u,i]),h=Math.ceil(x.length/50),p=(0,r.useMemo)(()=>{let e=(c-1)*50;return x.slice(e,e+50)},[x,c]),f=e=>new Intl.NumberFormat("en-US").format(e);return n?(0,a.jsx)(N,{open:t,onOpenChange:s,children:(0,a.jsxs)(S,{className:"max-w-7xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsx)(C,{children:(0,a.jsxs)(_,{className:"text-xl",children:["Segment ",n," Details",(0,a.jsxs)("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",x.length.toLocaleString()," items)"]})]})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(e8.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(ep,{placeholder:"Search by part number, location, or ID...",value:i,onChange:e=>{o(e.target.value),d(1)},className:"pl-9"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto border rounded-lg",children:(0,a.jsxs)(tz,{children:[(0,a.jsx)(tF,{className:"sticky top-0 bg-background z-10",children:(0,a.jsxs)(tM,{children:[(0,a.jsx)(tE,{className:"w-[140px]",children:"Part Number"}),(0,a.jsx)(tE,{className:"w-[160px]",children:"Location"}),(0,a.jsx)(tE,{className:"w-[80px] text-center",children:"ABC"}),(0,a.jsx)(tE,{className:"w-[80px] text-center",children:"XYZ"}),(0,a.jsx)(tE,{className:"w-[120px] text-right",children:"Safety Stock (Qty)"}),(0,a.jsx)(tE,{className:"w-[120px] text-right",children:"Safety Stock (Weeks)"}),(0,a.jsx)(tE,{className:"w-[120px] text-right",children:"Current Inventory"}),(0,a.jsx)(tE,{className:"w-[120px] text-right",children:"Excess"}),(0,a.jsx)(tE,{className:"w-[120px] text-right",children:"Stockout"}),(0,a.jsx)(tE,{className:"w-[120px] text-right",children:"Replenishment"})]})}),(0,a.jsx)(tD,{children:p.map(e=>(0,a.jsxs)(tM,{children:[(0,a.jsx)(tL,{className:"font-mono text-sm",children:e.partNumber}),(0,a.jsx)(tL,{className:"text-sm",children:e.location}),(0,a.jsx)(tL,{className:"text-center",children:(0,a.jsx)(X,{variant:"outline",className:"font-semibold",children:e.abc})}),(0,a.jsx)(tL,{className:"text-center",children:(0,a.jsx)(X,{variant:"outline",className:"font-semibold",children:e.xyz})}),(0,a.jsx)(tL,{className:"text-right font-medium",children:f(e.safetyStockQty)}),(0,a.jsxs)(tL,{className:"text-right text-muted-foreground",children:[e.safetyStockWeeks,"w"]}),(0,a.jsx)(tL,{className:"text-right font-medium",children:f(e.currentInventory)}),(0,a.jsx)(tL,{className:"text-right",children:e.excessAmount>0?(0,a.jsx)("span",{className:"text-red-500 font-medium",children:f(e.excessAmount)}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,a.jsx)(tL,{className:"text-right",children:e.stockoutAmount>0?(0,a.jsx)("span",{className:"text-amber-500 font-medium",children:f(e.stockoutAmount)}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,a.jsx)(tL,{className:"text-right",children:(0,a.jsx)("span",{className:"text-blue-500 font-medium",children:f(e.replenishmentAmount)})})]},e.id))})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between border-t pt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",((c-1)*50+1).toLocaleString()," to"," ",Math.min(50*c,x.length).toLocaleString()," of"," ",x.length.toLocaleString()," items"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(m,{variant:"outline",size:"sm",onClick:()=>d(e=>Math.max(1,e-1)),disabled:1===c,children:[(0,a.jsx)(tT.A,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,a.jsxs)("div",{className:"text-sm font-medium",children:["Page ",c," of ",h]}),(0,a.jsxs)(m,{variant:"outline",size:"sm",onClick:()=>d(e=>Math.min(h,e+1)),disabled:c===h,children:["Next",(0,a.jsx)(tU.A,{className:"h-4 w-4 ml-1"})]})]})]})]})}):null}var tR=s(18514);let tO={AX:"Lean inventory - high value meets predictability",AY:"Dynamic planning - valuable but variable",AZ:"Strategic buffer - protect critical revenue",BX:"Automated control - reliable mid-tier performers",BY:"Flexible response - adapt to moderate swings",BZ:"Balanced approach - mitigate uncertainty carefully",CX:"Bulk simplicity - cheap and steady",CY:"Liberal stock - low cost, moderate variability",CZ:"Accept risk - not worth the complexity"},tB={A:"Top 80% of Sales",B:"80-95% of Sales",C:"Bottom 5% of Sales"},tV={X:"Demand Variation <20%",Y:"Demand Variation = 20% - 50%",Z:"Demand Variation > 50%"},tH=(e,t)=>"A"===e&&"X"===t?"bg-green-500/10 border-green-500/30":"A"===e&&"Y"===t?"bg-yellow-500/10 border-yellow-500/30":"A"===e&&"Z"===t?"bg-red-500/10 border-red-500/30":"B"===e&&"X"===t?"bg-green-500/5 border-green-500/20":"B"===e&&"Y"===t?"bg-yellow-500/5 border-yellow-500/20":"B"===e&&"Z"===t?"bg-red-500/5 border-red-500/20":"bg-muted/30 border-border";function tW(e){let{selectedSegment:t,onSegmentClick:s,onSegmentDetails:n}=e,{formatCurrency:l}=eh(),{segmentation:i,products:o,loading:d}=eG(),u=(0,r.useMemo)(()=>{if(d||0===i.length)return[];let e=function(e,t,s){if(!Array.isArray(e)||!Array.isArray(t))return new Map;let a=new Map,r=["X","Y","Z"];["A","B","C"].forEach(e=>{r.forEach(t=>{let s="".concat(e).concat(t);a.set(s,{items:0,currentUnit:0,currentFinancial:0,targetUnit:0,targetFinancial:0,currentDays:0,targetDays:0})})});let n=Array.isArray(t)?"All Products"===s||"all"===s?t.map(e=>e.product_id):t.filter(e=>e.product_family===s).map(e=>e.product_id):[];return e.filter(e=>n.includes(e.product_id)).forEach(e=>{let t="".concat(e.ABC_value).concat(e.XYZ_value);if(a.has(t)){let s=a.get(t);s.items++,s.currentUnit+=e.on_hand_inventory_unit,s.currentFinancial+=e.on_hand_inventory_financial,s.targetUnit+=e.target_inventory_unit,s.targetFinancial+=e.target_inventory_financial,s.currentDays+=e.on_hand_inventory_days,s.targetDays+=e.target_inventory_days}}),a.forEach(e=>{e.items>0&&(e.currentDays=e.currentDays/e.items,e.targetDays=e.targetDays/e.items)}),a}(i,o,"All Products"),t=[];for(let[s,a]of e.entries()){let e=s[0],r=s[1],n=a.currentFinancial/4;t.push({abc:e,xyz:r,items:a.items,inventoryValue:a.currentFinancial,excessInventory:Math.max(0,a.currentFinancial-a.targetFinancial),stockout:0,replenishment:Math.max(0,a.targetFinancial-a.currentFinancial),currentInventoryWeeks:a.items>0?Math.round(a.currentDays):0,targetInventoryWeeks:a.items>0?Math.round(a.targetDays):0,avgWeeklyCost:n})}return t},[i,o,d]),[x,h]=(0,r.useState)(u.reduce((e,t)=>(e["".concat(t.abc).concat(t.xyz)]=t.targetInventoryWeeks,e),{})),[p,f]=(0,r.useState)(null),[g,j]=(0,r.useState)(0),[v,y]=(0,r.useState)(u.reduce((e,t)=>(e["".concat(t.abc).concat(t.xyz)]="days",e),{})),[b,w]=(0,r.useState)("days"),[k,I]=(0,r.useState)(null),[z,F]=(0,r.useState)(0),D=e=>{s(e)},M=(e,t)=>{e.stopPropagation(),f(t),j(x[t]||0),w(v[t]||"days")},R=(e,t,s)=>{e.stopPropagation(),I(t),F(s)},O=e=>{let t=u.filter(t=>t.abc===e);return["X","Y","Z"].map(e=>t.find(t=>t.xyz===e)||null)};return d?(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"Loading segmentation data..."})}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"space-y-1.5",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"ABC-XYZ Segmentation Analysis"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Strategic SKU classification combining sales financial contribution and demand variability"})]})}),(0,a.jsx)("div",{className:"space-y-1.5",children:(0,a.jsxs)("div",{className:"grid gap-2",style:{gridTemplateColumns:"auto 1fr 1fr 1fr"},children:[(0,a.jsx)("div",{className:"flex items-center justify-center h-12"}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-12 space-y-0.5",children:[(0,a.jsxs)("div",{className:"font-semibold text-foreground text-sm",children:["X",(0,a.jsx)("span",{className:"text-xs text-muted-foreground ml-1",children:"(Stable)"})]}),(0,a.jsx)("div",{className:"text-[10px] text-muted-foreground text-center leading-tight",children:tV.X})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-12 space-y-0.5",children:[(0,a.jsxs)("div",{className:"font-semibold text-foreground text-sm",children:["Y",(0,a.jsx)("span",{className:"text-xs text-muted-foreground ml-1",children:"(Variable)"})]}),(0,a.jsx)("div",{className:"text-[10px] text-muted-foreground text-center leading-tight",children:tV.Y})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-12 space-y-0.5",children:[(0,a.jsxs)("div",{className:"font-semibold text-foreground text-sm",children:["Z",(0,a.jsx)("span",{className:"text-xs text-muted-foreground ml-1",children:"(Volatile)"})]}),(0,a.jsx)("div",{className:"text-[10px] text-muted-foreground text-center leading-tight",children:tV.Z})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-0.5 min-w-[80px]",children:[(0,a.jsxs)("div",{className:"font-semibold text-foreground text-sm",children:["A",(0,a.jsx)("span",{className:"text-xs text-muted-foreground ml-1",children:"(High)"})]}),(0,a.jsx)("div",{className:"text-[10px] text-muted-foreground text-center leading-tight px-2",children:tB.A})]}),O("A").map((e,s)=>{if(!e)return(0,a.jsx)("div",{className:"min-h-[120px]"},"A-".concat(s));let r="".concat(e.abc).concat(e.xyz),n=t===r,i=x[r]||e.targetInventoryWeeks,o=i*e.avgWeeklyCost,d=e.currentInventoryWeeks*e.avgWeeklyCost;return(0,a.jsx)(e1,{onClick:()=>D(r),className:c("border-2 hover:shadow-md transition-all cursor-pointer",tH(e.abc,e.xyz),n&&"ring-2 ring-primary ring-offset-2 ring-offset-background"),children:(0,a.jsxs)(e5,{className:"p-2.5 space-y-1.5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-foreground",children:r}),(0,a.jsxs)(eU,{children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-transparent",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(eL.A,{className:"h-3.5 w-3.5 text-muted-foreground"})})}),(0,a.jsx)(eR,{className:"w-64 text-xs",side:"top",children:tO[r]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)("button",{onClick:t=>R(t,r,e.items),className:"text-xs font-medium text-primary hover:underline cursor-pointer",children:[e.items," items"]}),(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:e=>M(e,r),children:(0,a.jsx)(tR.A,{className:"h-3 w-3 text-muted-foreground"})})]})]}),(0,a.jsxs)("div",{className:"space-y-1 text-xs border-t border-border pt-1.5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-muted-foreground mb-0.5",children:"Current Inventory:"}),(0,a.jsxs)("div",{className:"flex justify-between items-center pl-2",children:[(0,a.jsx)("span",{className:"font-medium text-foreground",children:l(d)}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[e.currentInventoryWeeks," days"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-muted-foreground mb-0.5",children:"Target Inventory:"}),(0,a.jsxs)("div",{className:"flex justify-between items-center pl-2",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600",children:l(o)}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[i," ","days"===v[r]?"days":"units"]})]})]})]})]})},r)}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-0.5 min-w-[80px]",children:[(0,a.jsxs)("div",{className:"font-semibold text-foreground text-sm",children:["B",(0,a.jsx)("span",{className:"text-xs text-muted-foreground ml-1",children:"(Medium)"})]}),(0,a.jsx)("div",{className:"text-[10px] text-muted-foreground text-center leading-tight px-2",children:tB.B})]}),O("B").map((e,s)=>{if(!e)return(0,a.jsx)("div",{className:"min-h-[120px]"},"B-".concat(s));let r="".concat(e.abc).concat(e.xyz),n=t===r,i=x[r]||e.targetInventoryWeeks,o=i*e.avgWeeklyCost,d=e.currentInventoryWeeks*e.avgWeeklyCost;return(0,a.jsx)(e1,{onClick:()=>D(r),className:c("border-2 hover:shadow-md transition-all cursor-pointer",tH(e.abc,e.xyz),n&&"ring-2 ring-primary ring-offset-2 ring-offset-background"),children:(0,a.jsxs)(e5,{className:"p-2.5 space-y-1.5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-foreground",children:r}),(0,a.jsxs)(eU,{children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-transparent",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(eL.A,{className:"h-3.5 w-3.5 text-muted-foreground"})})}),(0,a.jsx)(eR,{className:"w-64 text-xs",side:"top",children:tO[r]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)("button",{onClick:t=>R(t,r,e.items),className:"text-xs font-medium text-primary hover:underline cursor-pointer",children:[e.items," items"]}),(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:e=>M(e,r),children:(0,a.jsx)(tR.A,{className:"h-3 w-3 text-muted-foreground"})})]})]}),(0,a.jsxs)("div",{className:"space-y-1 text-xs border-t border-border pt-1.5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-muted-foreground mb-0.5",children:"Current Inventory:"}),(0,a.jsxs)("div",{className:"flex justify-between items-center pl-2",children:[(0,a.jsx)("span",{className:"font-medium text-foreground",children:l(d)}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[e.currentInventoryWeeks," days"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-muted-foreground mb-0.5",children:"Target Inventory:"}),(0,a.jsxs)("div",{className:"flex justify-between items-center pl-2",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600",children:l(o)}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[i," ","days"===v[r]?"days":"units"]})]})]})]})]})},r)}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-0.5 min-w-[80px]",children:[(0,a.jsxs)("div",{className:"font-semibold text-foreground text-sm",children:["C",(0,a.jsx)("span",{className:"text-xs text-muted-foreground ml-1",children:"(Low)"})]}),(0,a.jsx)("div",{className:"text-[10px] text-muted-foreground text-center leading-tight px-2",children:tB.C})]}),O("C").map((e,s)=>{if(!e)return(0,a.jsx)("div",{className:"min-h-[120px]"},"C-".concat(s));let r="".concat(e.abc).concat(e.xyz),n=t===r,i=x[r]||e.targetInventoryWeeks,o=i*e.avgWeeklyCost,d=e.currentInventoryWeeks*e.avgWeeklyCost;return(0,a.jsx)(e1,{onClick:()=>D(r),className:c("border-2 hover:shadow-md transition-all cursor-pointer",tH(e.abc,e.xyz),n&&"ring-2 ring-primary ring-offset-2 ring-offset-background"),children:(0,a.jsxs)(e5,{className:"p-2.5 space-y-1.5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-foreground",children:r}),(0,a.jsxs)(eU,{children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-transparent",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(eL.A,{className:"h-3.5 w-3.5 text-muted-foreground"})})}),(0,a.jsx)(eR,{className:"w-64 text-xs",side:"top",children:tO[r]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)("button",{onClick:t=>R(t,r,e.items),className:"text-xs font-medium text-primary hover:underline cursor-pointer",children:[e.items," items"]}),(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:e=>M(e,r),children:(0,a.jsx)(tR.A,{className:"h-3 w-3 text-muted-foreground"})})]})]}),(0,a.jsxs)("div",{className:"space-y-1 text-xs border-t border-border pt-1.5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-muted-foreground mb-0.5",children:"Current Inventory:"}),(0,a.jsxs)("div",{className:"flex justify-between items-center pl-2",children:[(0,a.jsx)("span",{className:"font-medium text-foreground",children:l(d)}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[e.currentInventoryWeeks," days"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-muted-foreground mb-0.5",children:"Target Inventory:"}),(0,a.jsxs)("div",{className:"flex justify-between items-center pl-2",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600",children:l(o)}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[i," ","days"===v[r]?"days":"units"]})]})]})]})]})},r)})]})}),(0,a.jsx)(N,{open:null!==p,onOpenChange:e=>!e&&f(null),children:(0,a.jsxs)(S,{children:[(0,a.jsx)(C,{children:(0,a.jsxs)(_,{children:["Edit Target Inventory - ",p]})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Target Value"}),(0,a.jsx)(ep,{type:"number",value:g,onChange:e=>j(Number.parseFloat(e.target.value)||0),step:"0.5",min:"0",className:"w-full"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Unit of Measure"}),(0,a.jsxs)(E,{value:b,onValueChange:e=>w(e),children:[(0,a.jsx)(T,{className:"w-full",children:(0,a.jsx)(L,{})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"days",children:"Days on Hand"}),(0,a.jsx)(P,{value:"quantity",children:"Quantity"})]})]})]})]}),(0,a.jsxs)(A,{children:[(0,a.jsx)(m,{variant:"outline",onClick:()=>f(null),children:"Cancel"}),(0,a.jsx)(m,{onClick:()=>{p&&(h(e=>({...e,[p]:g})),y(e=>({...e,[p]:b})),f(null))},children:"Save Changes"})]})]})}),(0,a.jsx)(tP,{open:null!==k,onOpenChange:e=>!e&&I(null),segment:k,totalItems:z})]})}function tq(e){var t,s;let{viewMode:n,setViewMode:l,filters:i,setFilters:o,selectedSegment:c,setSelectedSegment:d,onSegmentDetails:u}=e,{measures:x,products:h,recommendations:p,loading:f}=eG(),[g,j]=(0,r.useState)("units"),[v,y]=(0,r.useState)(!1),[w,k]=(0,r.useState)(!1),[A,I]=(0,r.useState)(""),{formatCurrency:z,currency:F}=eh(),[M,R]=(0,r.useState)({demand:!0,scheduledSupply:!0,inTransit:!0,targetInventory:!0,targetInventoryDays:!0,onHandInventory:!0,onHandInventoryDays:!0,supplyRecommendations:!0}),O=(0,r.useMemo)(()=>{let e=eZ(h),t=[];return t.push({value:"All Products",label:"All Products",type:"family"}),e.slice(1).forEach(e=>{t.push({value:e.toLowerCase().replace(/\s+/g,"-"),label:e,type:"family"})}),h.forEach(e=>{t.push({value:"product-".concat(e.product_id),label:e.product_id,type:"product"})}),t},[h]),B=(0,r.useMemo)(()=>{if(!A.trim())return O.filter(e=>"family"===e.type);let e=A.toLowerCase();return O.filter(t=>t.label.toLowerCase().includes(e))},[O,A]),V=(0,r.useMemo)(()=>[{value:"All Locations",label:"All Locations"},...(!Array.isArray(x)?[]:[...new Set(x.map(e=>e.location_id))].sort()).map(e=>({value:e,label:e}))],[x]),H=(0,r.useMemo)(()=>p.filter(e=>"open"===e.status).map(e=>({id:e.id,type:e.type,partName:e.name,quantity:500,supplier:"purchase-order"===e.type?"Supplier":void 0,priority:e.severity,generatedDate:new Date().toISOString().split("T")[0]})),[p]),[W,q]=(0,r.useState)(H),[K,Y]=(0,r.useState)([]),[$,J]=(0,r.useState)(null),[ee,et]=(0,r.useState)(""),[ea,er]=(0,r.useState)(""),[en,el]=(0,r.useState)(null),[ei,eo]=(0,r.useState)(""),[ec,ed]=(0,r.useState)(""),[em,eu]=(0,r.useState)("all"),[ex,ef]=(0,r.useState)("all"),[eg,ej]=(0,r.useState)(null),[ev,ey]=(0,r.useState)("recommendations"),eN=e=>"dollars"===g?z(50*e):e.toLocaleString(),eb=e=>{R(t=>({...t,[e]:!t[e]}))},ew=(0,r.useMemo)(()=>{var e;let t;if(f||0===x.length)return[];let s="All Products",a=[];if(i.product.startsWith("product-")){let e=i.product.replace("product-","");a=[e],console.log("[v0] Selected individual product:",e);let t=h.find(t=>t.product_id===e);s=(null==t?void 0:t.product_family)||"All Products"}else{let e=O.find(e=>e.value===i.product);console.log("[v0] Selected product family:",s=(null==e?void 0:e.label)||"All Products")}let r=(null==(e=V.find(e=>e.value===i.location))?void 0:e.label)||"All Locations";if(console.log("[v0] Selected location:",r),a.length>0){let e=x.filter(e=>a.includes(e.product_id));console.log("[v0] Total measures for product:",e.length),console.log("[v0] Sample measure data:",e[0]),"All Locations"!==r&&console.log("[v0] Measures after location filter:",(e=e.filter(e=>e.location_id===r)).length);let s=new Map;e.forEach(e=>{let t=e.measure_id;s.has(t)||s.set(t,[]),s.get(t).push(e)}),console.log("[v0] Measure types found:",Array.from(s.keys())),t=new Map,s.forEach((e,s)=>{if(s.includes("days")){let a=Array(20).fill(0);for(let t=0;t<20;t++){let s=e.map(e=>e.weeks[t]);a[t]=s.reduce((e,t)=>e+t,0)/s.length}t.set(s,a),"on_hand_inventory_days_unit_value"===s&&console.log("[v0] CSV on_hand_inventory_days (first 4 weeks):",a.slice(0,4))}else{let a=Array(20).fill(0);for(let t=0;t<20;t++)a[t]=e.reduce((e,s)=>e+s.weeks[t],0);t.set(s,a)}});let n=t.get("demand_unit_value");n&&console.log("[v0] Sample demand data (first 4 weeks):",n.slice(0,4));let l=t.get("on_hand_inventory_unit_value");l&&console.log("[v0] On hand inventory (first 4 weeks):",l.slice(0,4))}else t=function(e,t,s,a){if(!Array.isArray(e)||!Array.isArray(t))return new Map;let r="All Products"===s||"all"===s?t.map(e=>e.product_id):t.filter(e=>e.product_family===s).map(e=>e.product_id),n=e.filter(e=>r.includes(e.product_id));"All Locations"!==a&&"all"!==a&&(n=n.filter(e=>e.location_id===a));let l=new Map;n.forEach(e=>{let t=e.measure_id;l.has(t)||l.set(t,[]),l.get(t).push(e)});let i=new Map;return l.forEach((e,t)=>{if(t.includes("days")){let s=Array(20).fill(0);for(let t=0;t<20;t++){let a=e.map(e=>e.weeks[t]).filter(e=>!isNaN(e));s[t]=a.length>0?a.reduce((e,t)=>e+t,0)/a.length:0}i.set(t,s)}else{let s=Array(20).fill(0);for(let t=0;t<20;t++)s[t]=e.reduce((e,s)=>e+(s.weeks[t]||0),0);i.set(t,s)}}),i}(x,h,s,r);let n=t.get("demand_unit_value")||Array(20).fill(0),l=t.get("demand_financial_value")||Array(20).fill(0),o=t.get("scheduled_supply_unit_value")||Array(20).fill(0),c=t.get("scheduled_supply_financial_value")||Array(20).fill(0),d=t.get("in_transit_unit_value")||Array(20).fill(0),m=t.get("in_transit_financial_value")||Array(20).fill(0),u=t.get("on_hand_inventory_unit_value")||Array(20).fill(0),p=t.get("on_hand_inventory_financial_value")||Array(20).fill(0),j=t.get("target_inventory_unit_value")||Array(20).fill(0),v=t.get("target_inventory_financial_value")||Array(20).fill(0),y=t.get("on_hand_inventory_days_unit_value")||Array(20).fill(0),N=t.get("target_inventory_days_unit_value")||Array(20).fill(0),b=(e=>{let t=new Date(e),s=t.getDay(),a=t.getDate()-s+(0===s?-6:1);return new Date(t.setDate(a))})(new Date),w=[];for(let e=0;e<20;e++){let t=new Date(b);t.setDate(b.getDate()+7*e);let s="W".concat(e+1),a="".concat((t.getMonth()+1).toString().padStart(2,"0"),"/").concat(t.getDate().toString().padStart(2,"0"));w.push({week:s,date:a,demand:"units"===g?n[e]:l[e],scheduledSupply:"units"===g?o[e]:c[e],inTransit:"units"===g?d[e]:m[e],onHandInventory:"units"===g?u[e]:p[e],targetInventory:"units"===g?j[e]:v[e],onHandInventoryDays:y[e],targetInventoryDays:N[e]})}return w},[x,h,i.product,i.location,g,f,O,V]),ek=(e,t)=>{if(J(e),et(t),"accepted"===t){let t=W.find(t=>t.id===e);t&&(Y([...K,{...t,action:"accepted",timestamp:new Date().toLocaleTimeString()}]),q(W.filter(t=>t.id!==e)),J(null),et(""),ey("actions"))}else er("")},eS=e=>{if(!ea.trim())return;let t=W.find(t=>t.id===e);t&&(Y([...K,{...t,action:"rejected",reason:ea,timestamp:new Date().toLocaleTimeString()}]),q(W.filter(t=>t.id!==e)),J(null),et(""),er(""),ey("actions"))},eC=()=>{J(null),et(""),er("")},eA=()=>{el(null),eo(""),ed("")},e_=e=>"purchase-order"===e.type?"".concat(e.partName," - ").concat(e.quantity," units from ").concat(e.supplier):"inventory-deficit"===e.type?"".concat(e.partName," - Deficit: ").concat(e.quantity," units needed"):"".concat(e.partName," - Excess: ").concat(e.quantity," units over target"),eI=e=>"inventory-deficit"===e.type?"Based on current demand trends and lead times, ".concat(e.partName," inventory is projected to fall below safety stock levels within the next 2 weeks. Historical data shows a 23% increase in demand for this part, requiring immediate replenishment of ").concat(e.quantity," units to maintain service levels."):"inventory-excess"===e.type?"Analysis of the past 90 days shows ".concat(e.partName," has consistently exceeded target inventory levels by an average of ").concat(e.quantity," units. Demand forecasts indicate this trend will continue, tying up capital and warehouse space. Consider reducing order quantities or implementing promotional strategies."):"Supply chain optimization analysis recommends placing a purchase order for ".concat(e.quantity," units of ").concat(e.partName," from ").concat(e.supplier,". This supplier offers the best combination of price, lead time (7-10 days), and quality ratings (4.8/5.0). Order now to prevent stockouts and maintain optimal inventory levels."),ez=e=>{ej(eg===e?null:e)},eF=e=>{switch(e){case"inventory-deficit":return"Low Inventory Alert";case"inventory-excess":return"Excess Inventory Alert";case"purchase-order":return"Purchase Order Required"}},eD=W.filter(e=>{let t="all"===em||e.priority===em,s="all"===ex||"inventory"===ex&&("inventory-deficit"===e.type||"inventory-excess"===e.type)||"purchase"===ex&&"purchase-order"===e.type;return t&&s}),eM=eD.filter(e=>"inventory-deficit"===e.type||"inventory-excess"===e.type),eE=eD.filter(e=>"purchase-order"===e.type),eL=(e=>{switch(e){case"4w":return 4;case"8w":return 8;case"12w":return 12;case"16w":return 16;default:return 20}})(i.timeRange),eT=ew.slice(0,eL);return f?(0,a.jsx)(e1,{className:"bg-card border-border",children:(0,a.jsx)(e5,{className:"p-8",children:(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:"Loading supply chain data..."})})}):(0,a.jsxs)(e1,{className:"bg-card border-border",children:[(0,a.jsx)(e2,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(e4,{className:"text-foreground",children:"Supply Chain Trends"}),(0,a.jsxs)(E,{value:g,onValueChange:e=>j(e),children:[(0,a.jsx)(T,{className:"w-[100px] h-9",children:(0,a.jsx)(L,{})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"units",children:"Units"}),(0,a.jsx)(P,{value:"dollars",children:"USD"===F?"$":"EUR"===F?"€":"₹"})]})]}),(0,a.jsxs)(N,{children:[(0,a.jsx)(b,{asChild:!0,children:(0,a.jsx)(m,{variant:"ghost",size:"sm",className:"h-9 w-9 p-0",children:(0,a.jsx)(tg.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(S,{children:[(0,a.jsx)(C,{children:(0,a.jsx)(_,{children:"Customize Metrics"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"demand",checked:M.demand,onCheckedChange:()=>eb("demand")}),(0,a.jsx)("label",{htmlFor:"demand",className:"text-sm font-medium leading-none cursor-pointer",children:"Demand"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"scheduledSupply",checked:M.scheduledSupply,onCheckedChange:()=>eb("scheduledSupply")}),(0,a.jsx)("label",{htmlFor:"scheduledSupply",className:"text-sm font-medium leading-none cursor-pointer",children:"Scheduled Supply"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"inTransit",checked:M.inTransit,onCheckedChange:()=>eb("inTransit")}),(0,a.jsx)("label",{htmlFor:"inTransit",className:"text-sm font-medium leading-none cursor-pointer",children:"In-Transit"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"targetInventory",checked:M.targetInventory,onCheckedChange:()=>eb("targetInventory")}),(0,a.jsx)("label",{htmlFor:"targetInventory",className:"text-sm font-medium leading-none cursor-pointer",children:"Target Inventory"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"targetInventoryDays",checked:M.targetInventoryDays,onCheckedChange:()=>eb("targetInventoryDays")}),(0,a.jsx)("label",{htmlFor:"targetInventoryDays",className:"text-sm font-medium leading-none cursor-pointer",children:"Target Inventory (days on hand)"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"onHandInventory",checked:M.onHandInventory,onCheckedChange:()=>eb("onHandInventory")}),(0,a.jsx)("label",{htmlFor:"onHandInventory",className:"text-sm font-medium leading-none cursor-pointer",children:"On Hand Inventory"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"onHandInventoryDays",checked:M.onHandInventoryDays,onCheckedChange:()=>eb("onHandInventoryDays")}),(0,a.jsx)("label",{htmlFor:"onHandInventoryDays",className:"text-sm font-medium leading-none cursor-pointer",children:"On Hand Inventory (days on hand)"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{id:"supplyRecommendations",checked:M.supplyRecommendations,onCheckedChange:()=>eb("supplyRecommendations")}),(0,a.jsx)("label",{htmlFor:"supplyRecommendations",className:"text-sm font-medium leading-none cursor-pointer",children:"Supply Recommendations"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsxs)(eU,{open:v,onOpenChange:y,children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsxs)(m,{variant:"outline",role:"combobox","aria-expanded":v,className:"w-[200px] justify-between h-9 bg-transparent",children:[(null==(t=O.find(e=>e.value===i.product))?void 0:t.label)||"Select product...",(0,a.jsx)(tr.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(eR,{className:"w-[200px] p-0",children:(0,a.jsxs)(e6,{children:[(0,a.jsx)(e9,{placeholder:"Search product...",value:A,onValueChange:I}),(0,a.jsxs)(e7,{children:[(0,a.jsx)(te,{children:"No product found."}),(0,a.jsx)(tt,{children:B.map(e=>(0,a.jsxs)(ts,{value:e.value,onSelect:e=>{o({...i,product:e}),y(!1),I("")},className:"product"===e.type?"text-sm":"font-medium",children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4 ".concat(i.product===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})]})})]}),(0,a.jsxs)(eU,{open:w,onOpenChange:k,children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsxs)(m,{variant:"outline",role:"combobox","aria-expanded":w,className:"w-[180px] justify-between h-9 bg-transparent",children:[(null==(s=V.find(e=>e.value===i.location))?void 0:s.label)||"Select location...",(0,a.jsx)(tr.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(eR,{className:"w-[180px] p-0",children:(0,a.jsxs)(e6,{children:[(0,a.jsx)(e9,{placeholder:"Search location..."}),(0,a.jsxs)(e7,{children:[(0,a.jsx)(te,{children:"No location found."}),(0,a.jsx)(tt,{children:V.map(e=>(0,a.jsxs)(ts,{value:e.value,onSelect:e=>{o({...i,location:e}),k(!1)},children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4 ".concat(i.location===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})]})})]}),(0,a.jsxs)(E,{value:i.timeRange,onValueChange:e=>o({...i,timeRange:e}),children:[(0,a.jsx)(T,{className:"w-[140px]",children:(0,a.jsx)(L,{placeholder:"Time Range"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"4w",children:"Next 4 weeks"}),(0,a.jsx)(P,{value:"8w",children:"Next 8 weeks"}),(0,a.jsx)(P,{value:"12w",children:"Next 12 weeks"}),(0,a.jsx)(P,{value:"16w",children:"Next 16 weeks"}),(0,a.jsx)(P,{value:"20w",children:"Next 20 weeks"})]})]}),(0,a.jsxs)("div",{className:"flex gap-1 border border-border rounded-lg p-1",children:[(0,a.jsx)(m,{variant:"chart"===n?"secondary":"ghost",size:"sm",onClick:()=>l("chart"),className:"h-8 px-3",children:(0,a.jsx)(tj.A,{className:"h-4 w-4"})}),(0,a.jsx)(m,{variant:"table"===n?"secondary":"ghost",size:"sm",onClick:()=>l("table"),className:"h-8 px-3",children:(0,a.jsx)(tv.A,{className:"h-4 w-4"})}),(0,a.jsx)(m,{variant:"segmentation"===n?"secondary":"ghost",size:"sm",onClick:()=>l("segmentation"),className:"h-8 px-3",children:(0,a.jsx)(ty.A,{className:"h-4 w-4"})})]})]})]})}),(0,a.jsxs)(e5,{className:"space-y-6",children:[(0,a.jsx)("div",{className:"rounded-lg bg-muted/50 p-4 border border-border",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"segmentation"===n?c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"font-semibold text-foreground",children:[c," Segment Analysis:"]})," ","A"===c[0]?"High-value items requiring close monitoring. ":"B"===c[0]?"Medium-value items with balanced approach. ":"Low-value items suitable for periodic review. ","X"===c[1]?"Stable demand pattern allows for optimized inventory levels with minimal safety stock.":"Y"===c[1]?"Variable demand requires dynamic safety stock and flexible replenishment strategies.":"Volatile demand necessitates higher safety stock and frequent monitoring to prevent stockouts."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"font-semibold text-foreground",children:"Segmentation Insights:"})," High-value items (A category) represent 105 SKUs with $5.15M inventory value. AZ segment shows highest risk with $450K replenishment needs due to volatile demand. Focus inventory optimization on AX and BX segments for maximum ROI, while implementing safety stock strategies for volatile Z-category items."]}):"table"===n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"font-semibold text-foreground",children:"Forward-Looking Analysis:"})," Projected demand growth of 2.7% weekly over the next ",eL," weeks. Inventory levels trending downward, requiring proactive supply planning. Multiple weeks show potential shortages where demand exceeds available supply. Review supply recommendations to prevent stockouts and optimize inventory levels."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"font-semibold text-foreground",children:"Supply Forecast:"})," Forward-looking 20-week projection shows steady demand growth with scheduled supply tracking closely. In-transit inventory provides buffer, while on-hand inventory requires careful monitoring. Trend lines indicate potential capacity constraints in weeks 15-20 requiring advance planning."]})})}),"segmentation"===n?(0,a.jsx)(tW,{selectedSegment:c,onSegmentClick:e=>{c===e?d(null):d(e)},onSegmentDetails:u}):"chart"===n?(0,a.jsx)(tb.u,{width:"100%",height:450,children:(0,a.jsxs)(tw.b,{data:eT,margin:{top:5,right:30,left:20,bottom:60},children:[(0,a.jsx)(tk.d,{strokeDasharray:"3 3",className:"stroke-muted-foreground",opacity:.3}),(0,a.jsx)(tS.W,{dataKey:"week",className:"text-foreground",tick:{fill:"currentColor",fontSize:12},tickLine:{stroke:"currentColor"},axisLine:{stroke:"currentColor"}}),(0,a.jsx)(tC.h,{className:"text-foreground",tick:{fill:"currentColor",fontSize:12},tickLine:{stroke:"currentColor"},axisLine:{stroke:"currentColor"},type:"number",domain:["dataMin","dataMax"],allowDecimals:!0,tickCount:5,interval:"preserveStartEnd",tickFormatter:e=>{if(0===e)return"0";let t=e;return("dollars"===g&&(t=50*e),Math.abs(t)>=1e6)?"dollars"===g?z(t/1e6)+"M":"".concat((t/1e6).toFixed(1),"M"):Math.abs(t)>=1e3?"dollars"===g?z(t/1e3)+"K":"".concat((t/1e3).toFixed(1),"K"):"dollars"===g?z(t):t.toFixed(1)}}),(0,a.jsx)(tA.m,{contentStyle:{backgroundColor:"hsl(var(--popover))",border:"1px solid hsl(var(--border))",borderRadius:"var(--radius)",color:"hsl(var(--popover-foreground))"},formatter:e=>eN(e)}),(0,a.jsx)(t_.s,{wrapperStyle:{paddingTop:"20px"}}),M.demand&&(0,a.jsx)(tI.N,{type:"monotone",dataKey:"demand",stroke:"#ef4444",strokeWidth:2,name:"Demand",dot:!1}),M.scheduledSupply&&(0,a.jsx)(tI.N,{type:"monotone",dataKey:"scheduledSupply",stroke:"#3b82f6",strokeWidth:2,name:"Scheduled Supply",dot:!1}),M.inTransit&&(0,a.jsx)(tI.N,{type:"monotone",dataKey:"inTransit",stroke:"#f59e0b",strokeWidth:2,name:"In-Transit",dot:!1}),M.targetInventory&&(0,a.jsx)(tI.N,{type:"monotone",dataKey:"targetInventory",stroke:"#8b5cf6",strokeWidth:2,strokeDasharray:"5 5",name:"Target Inventory",dot:!1}),M.targetInventoryDays&&(0,a.jsx)(tI.N,{type:"monotone",dataKey:"targetInventoryDays",stroke:"#a78bfa",strokeWidth:2,strokeDasharray:"5 5",name:"Target Inventory (days)",dot:!1}),M.onHandInventory&&(0,a.jsx)(tI.N,{type:"monotone",dataKey:"onHandInventory",stroke:"#22c55e",strokeWidth:2,name:"On Hand Inventory",dot:!1}),M.onHandInventoryDays&&(0,a.jsx)(tI.N,{type:"monotone",dataKey:"onHandInventoryDays",stroke:"#4ade80",strokeWidth:2,name:"On Hand Inventory (days)",dot:!1})]})}):(0,a.jsx)("div",{className:"rounded-lg border border-border overflow-x-auto",children:(0,a.jsxs)(tz,{children:[(0,a.jsx)(tF,{children:(0,a.jsxs)(tM,{children:[(0,a.jsx)(tE,{className:"sticky left-0 bg-muted z-10 min-w-[120px]",children:"Measures"}),eT.map(e=>(0,a.jsxs)(tE,{className:"text-center min-w-[100px]",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.week}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground font-normal",children:e.date})]},e.week))]})}),(0,a.jsxs)(tD,{children:[M.demand&&(0,a.jsxs)(tM,{children:[(0,a.jsx)(tL,{className:"sticky left-0 bg-muted z-10 font-medium",children:"Demand"}),eT.map(e=>(0,a.jsx)(tL,{className:"text-center",children:eN(e.demand)},e.week))]}),M.scheduledSupply&&(0,a.jsxs)(tM,{children:[(0,a.jsx)(tL,{className:"sticky left-0 bg-muted z-10 font-medium",children:"Scheduled Supply"}),eT.map(e=>(0,a.jsx)(tL,{className:"text-center",children:eN(e.scheduledSupply)},e.week))]}),M.inTransit&&(0,a.jsxs)(tM,{children:[(0,a.jsx)(tL,{className:"sticky left-0 bg-muted z-10 font-medium",children:"In-Transit"}),eT.map(e=>(0,a.jsx)(tL,{className:"text-center",children:eN(e.inTransit)},e.week))]}),M.targetInventory&&(0,a.jsxs)(tM,{children:[(0,a.jsx)(tL,{className:"sticky left-0 bg-muted z-10 font-medium",children:"Target Inventory"}),eT.map(e=>(0,a.jsx)(tL,{className:"text-center text-muted-foreground",children:eN(e.targetInventory)},e.week))]}),M.targetInventoryDays&&(0,a.jsxs)(tM,{children:[(0,a.jsx)(tL,{className:"sticky left-0 bg-muted z-10 font-medium",children:"Target Inventory (days on hand)"}),eT.map(e=>(0,a.jsxs)(tL,{className:"text-center text-muted-foreground",children:[e.targetInventoryDays," days"]},e.week))]}),M.onHandInventory&&(0,a.jsxs)(tM,{children:[(0,a.jsx)(tL,{className:"sticky left-0 bg-muted z-10 font-medium",children:"On Hand Inventory"}),eT.map(e=>{let t=e.onHandInventory<e.targetInventory,s=e.onHandInventory-e.targetInventory;return(0,a.jsxs)(tL,{className:"text-center font-medium ".concat(t?"text-red-500 bg-red-500/10":"text-green-500 bg-green-500/10"),children:[(0,a.jsx)("div",{children:eN(e.onHandInventory)}),(0,a.jsxs)("div",{className:"text-xs mt-0.5",children:["(",t?"":"+",eN(Math.abs(s)),")"]})]},e.week)})]}),M.onHandInventoryDays&&(0,a.jsxs)(tM,{children:[(0,a.jsx)(tL,{className:"sticky left-0 bg-muted z-10 font-medium",children:"On Hand Inventory (days on hand)"}),eT.map(e=>{let t=e.onHandInventoryDays,s=e.targetInventoryDays,r=t<s,n=t-s;return(0,a.jsxs)(tL,{className:"text-center font-medium ".concat(r?"text-red-500 bg-red-500/10":"text-green-500 bg-green-500/10"),children:[(0,a.jsxs)("div",{children:[t," days"]}),(0,a.jsxs)("div",{className:"text-xs mt-0.5",children:["(",r?"":"+",Math.abs(n).toFixed(1)," days)"]})]},e.week)})]}),M.supplyRecommendations&&(0,a.jsxs)(tM,{className:"border-t-2",children:[(0,a.jsx)(tL,{className:"sticky left-0 bg-muted z-10 font-semibold",children:"Supply Recommendations"}),eT.map(e=>{let t=((e,t,s,a)=>{let r=e-(t+s+a);return r>0?{value:r,type:"shortage"}:r<-5e3?{value:Math.abs(r),type:"excess"}:{value:0,type:"balanced"}})(e.demand,e.scheduledSupply,e.inTransit,e.onHandInventory);return(0,a.jsxs)(tL,{className:"text-center font-medium ".concat("shortage"===t.type?"text-red-500 bg-red-500/10":"excess"===t.type?"text-green-500 bg-green-500/10":""),children:["shortage"===t.type&&"↓ ".concat(eN(t.value)),"excess"===t.type&&"↑ ".concat(eN(t.value)),"balanced"===t.type&&"—"]},e.week)})]})]})]})}),(W.length>0||K.length>0)&&(0,a.jsxs)("div",{id:"recommendations-section",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6 border-b border-border",children:[(0,a.jsxs)("button",{onClick:()=>ey("recommendations"),className:"pb-3 px-1 text-sm font-medium transition-colors relative ".concat("recommendations"===ev?"text-foreground":"text-muted-foreground hover:text-foreground"),children:["Recommendations","recommendations"===ev&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]}),(0,a.jsxs)("button",{onClick:()=>ey("actions"),className:"pb-3 px-1 text-sm font-medium transition-colors relative ".concat("actions"===ev?"text-foreground":"text-muted-foreground hover:text-foreground"),children:["Actions","actions"===ev&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]})]}),"recommendations"===ev&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsxs)(E,{value:em,onValueChange:eu,children:[(0,a.jsx)(T,{className:"w-[130px]",children:(0,a.jsx)(L,{placeholder:"Severity"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"all",children:"All Severity"}),(0,a.jsx)(P,{value:"high",children:"High"}),(0,a.jsx)(P,{value:"medium",children:"Medium"}),(0,a.jsx)(P,{value:"low",children:"Low"})]})]}),(0,a.jsxs)(E,{value:ex,onValueChange:ef,children:[(0,a.jsx)(T,{className:"w-[150px]",children:(0,a.jsx)(L,{placeholder:"Theme"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"all",children:"All Themes"}),(0,a.jsx)(P,{value:"inventory",children:"Inventory Alerts"}),(0,a.jsx)(P,{value:"purchase",children:"Purchase Orders"})]})]})]}),eM.length>0&&(0,a.jsx)("div",{className:"space-y-3",children:eM.map(e=>(0,a.jsx)("div",{className:"flex flex-col gap-3 p-4 rounded-lg border border-border bg-muted/30",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex gap-4 flex-1",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center flex-shrink-0 ".concat("inventory-deficit"===e.type?"bg-red-500/10":"bg-amber-500/10"),children:(0,a.jsx)(tx.A,{className:"h-5 w-5 ".concat("inventory-deficit"===e.type?"text-red-500":"text-amber-500")})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(X,{variant:"inventory-deficit"===e.type?"destructive":"secondary",className:"text-xs",children:eF(e.type)}),(0,a.jsx)(X,{variant:"high"===e.priority?"destructive":"medium"===e.priority?"default":"secondary",className:"text-xs",children:e.priority}),(0,a.jsx)(m,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-primary/10",title:"View explanation",onClick:()=>ez(e.id),children:(0,a.jsx)(Q.A,{className:"h-3.5 w-3.5 ".concat(eg===e.id?"text-primary fill-primary":"text-primary")})})]}),(0,a.jsx)("h4",{className:"font-semibold text-foreground text-sm mb-1",children:e_(e)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Generated: ",e.generatedDate]}),eg===e.id&&(0,a.jsx)("div",{className:"mt-2 p-3 rounded-md bg-primary/5 border border-primary/20",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:eI(e)})})]})]}),$===e.id&&"rejected"===ee?(0,a.jsxs)("div",{className:"flex flex-col gap-2 md:w-64",children:[(0,a.jsx)(ep,{placeholder:"Enter reason for rejection...",value:ea,onChange:e=>er(e.target.value),className:"h-9 text-sm",autoFocus:!0}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m,{size:"sm",variant:"destructive",className:"flex-1",onClick:()=>eS(e.id),disabled:!ea.trim(),children:"Confirm"}),(0,a.jsx)(m,{size:"sm",variant:"outline",className:"flex-1 bg-transparent",onClick:eC,children:"Cancel"})]})]}):(0,a.jsxs)(E,{onValueChange:t=>ek(e.id,t),children:[(0,a.jsx)(T,{className:"w-[140px]",children:(0,a.jsx)(L,{placeholder:"Take Action"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"accepted",children:"Accept"}),(0,a.jsx)(P,{value:"rejected",children:"Reject"})]})]})]})},e.id))}),eE.length>0&&(0,a.jsx)("div",{className:"space-y-3",children:eE.map(e=>(0,a.jsx)("div",{className:"flex flex-col gap-3 p-4 rounded-lg border border-border bg-muted/30",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex gap-4 flex-1",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center flex-shrink-0 bg-blue-500/10",children:(0,a.jsx)(ta.A,{className:"h-5 w-5 text-blue-500"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(X,{variant:"default",className:"text-xs",children:eF(e.type)}),(0,a.jsx)(X,{variant:"high"===e.priority?"destructive":"medium"===e.priority?"default":"secondary",className:"text-xs",children:e.priority}),(0,a.jsx)(m,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-primary/10",title:"View explanation",onClick:()=>ez(e.id),children:(0,a.jsx)(Q.A,{className:"h-3.5 w-3.5 ".concat(eg===e.id?"text-primary fill-primary":"text-primary")})})]}),(0,a.jsx)("h4",{className:"font-semibold text-foreground text-sm mb-1",children:e_(e)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Generated: ",e.generatedDate]}),eg===e.id&&(0,a.jsx)("div",{className:"mt-2 p-3 rounded-md bg-primary/5 border border-primary/20",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:eI(e)})})]})]}),$===e.id&&"rejected"===ee?(0,a.jsxs)("div",{className:"flex flex-col gap-2 md:w-64",children:[(0,a.jsx)(ep,{placeholder:"Enter reason for rejection...",value:ea,onChange:e=>er(e.target.value),className:"h-9 text-sm",autoFocus:!0}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m,{size:"sm",variant:"destructive",className:"flex-1",onClick:()=>eS(e.id),disabled:!ea.trim(),children:"Confirm"}),(0,a.jsx)(m,{size:"sm",variant:"outline",className:"flex-1 bg-transparent",onClick:eC,children:"Cancel"})]})]}):(0,a.jsxs)(E,{onValueChange:t=>ek(e.id,t),children:[(0,a.jsx)(T,{className:"w-[140px]",children:(0,a.jsx)(L,{placeholder:"Take Action"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"accepted",children:"Accept"}),(0,a.jsx)(P,{value:"rejected",children:"Reject"})]})]})]})},e.id))}),0===eD.length&&(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No recommendations match the selected filters."})]}),"actions"===ev&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-muted-foreground",children:"Completed Actions"}),(0,a.jsxs)(m,{size:"sm",children:[(0,a.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Add Action"]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[K.map(e=>(0,a.jsx)("div",{className:"flex flex-col gap-3 p-4 rounded-lg border border-border bg-card hover:bg-accent/5 transition-colors",children:en===e.id?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"flex items-start justify-between gap-3",children:(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"text-sm text-foreground font-medium",children:"purchase-order"===e.type?"Order ".concat(e.quantity," units of ").concat(e.partName," from ").concat(e.supplier):"inventory-deficit"===e.type?"Address deficit: ".concat(e.partName," - ").concat(e.quantity," units needed"):"Reduce excess: ".concat(e.partName," - ").concat(e.quantity," units over target")})})}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)(E,{value:ei,onValueChange:e=>{eo(e),"accepted"===e&&ed("")},children:[(0,a.jsx)(T,{className:"w-full",children:(0,a.jsx)(L,{placeholder:"Change status"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"accepted",children:"Accept"}),(0,a.jsx)(P,{value:"rejected",children:"Reject"})]})]}),"rejected"===ei&&(0,a.jsx)(ep,{placeholder:"Enter reason for rejection...",value:ec,onChange:e=>ed(e.target.value),className:"h-9 text-sm"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m,{size:"sm",variant:"default",className:"flex-1",onClick:()=>{var t;return t=e.id,void(("rejected"!==ei||ec.trim())&&(Y(K.map(e=>e.id===t?{...e,action:ei,reason:"rejected"===ei?ec:void 0,timestamp:new Date().toLocaleTimeString()}:e)),el(null),eo(""),ed("")))},disabled:"rejected"===ei&&!ec.trim(),children:"Save"}),(0,a.jsx)(m,{size:"sm",variant:"outline",className:"flex-1 bg-transparent",onClick:eA,children:"Cancel"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-foreground font-medium",children:"purchase-order"===e.type?"Order ".concat(e.quantity," units of ").concat(e.partName," from ").concat(e.supplier):"inventory-deficit"===e.type?"Address deficit: ".concat(e.partName," - ").concat(e.quantity," units needed"):"Reduce excess: ".concat(e.partName," - ").concat(e.quantity," units over target")}),e.reason&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Rejection reason:"})," ",e.reason]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(X,{variant:"accepted"===e.action?"default":"destructive",className:"capitalize shrink-0",children:"accepted"===e.action?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es.A,{className:"h-3 w-3 mr-1"}),"Accepted"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tx.A,{className:"h-3 w-3 mr-1"}),"Rejected"]})}),(0,a.jsx)(m,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0",onClick:()=>{var t,s,a;return t=e.id,s=e.action,a=e.reason,void(el(t),eo(s),ed(a||""))},children:(0,a.jsx)(tN.A,{className:"h-3.5 w-3.5"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(X,{variant:"outline",className:"text-xs",children:(e=>{switch(e){case"inventory-deficit":return"Deficit";case"inventory-excess":return"Excess";case"purchase-order":return"PO"}})(e.type)}),(0,a.jsxs)("span",{children:["Generated: ",e.generatedDate]})]}),(0,a.jsxs)("span",{children:["Actioned: ",e.timestamp]})]})]})},e.id)),0===K.length&&(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No actions yet. Accept or reject recommendations to see them here."})]})]})]})]})]})}var tX=s(5937),tK=s(18085);function tZ(){let[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(""),[l,i]=(0,r.useState)([{role:"assistant",content:"Hi! I'm your Trelliso AI assistant. Ask me anything about your supply chain data."}]),o=()=>{s.trim()&&(i([...l,{role:"user",content:s}]),n(""),setTimeout(()=>{i(e=>[...e,{role:"assistant",content:"I can help you analyze that. Based on current data, I recommend reviewing your inventory levels in the North America region."}])},1e3))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m,{onClick:()=>t(!e),className:c("fixed bottom-6 right-6 h-14 w-14 rounded-full shadow-lg transition-all",e&&"scale-0"),size:"icon",children:(0,a.jsx)(tX.A,{className:"h-6 w-6"})}),(0,a.jsxs)(e1,{className:c("fixed bottom-6 right-6 w-[380px] shadow-2xl transition-all duration-300 border-border",e?"scale-100 opacity-100":"scale-0 opacity-0"),children:[(0,a.jsxs)(e2,{className:"flex flex-row items-center justify-between space-y-0 pb-4 bg-primary text-primary-foreground rounded-t-lg",children:[(0,a.jsx)(e4,{className:"text-base font-semibold",children:"Trelliso AI Assistant"}),(0,a.jsx)(m,{variant:"ghost",size:"icon",onClick:()=>t(!1),className:"h-8 w-8 hover:bg-primary-foreground/20 text-primary-foreground",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)(e5,{className:"p-0",children:[(0,a.jsx)("div",{className:"h-[400px] overflow-y-auto p-4 space-y-4 bg-background",children:l.map((e,t)=>(0,a.jsx)("div",{className:c("flex","user"===e.role?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:c("max-w-[80%] rounded-lg px-4 py-2 text-sm","user"===e.role?"bg-primary text-primary-foreground":"bg-muted text-foreground"),children:e.content})},t))}),(0,a.jsx)("div",{className:"border-t border-border p-4 bg-card",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(ep,{placeholder:"Ask a question...",value:s,onChange:e=>n(e.target.value),onKeyDown:e=>"Enter"===e.key&&o(),className:"flex-1"}),(0,a.jsx)(m,{onClick:o,size:"icon",children:(0,a.jsx)(tK.A,{className:"h-4 w-4"})})]})})]})]})]})}var tY=s(16485);function t$(e){let{open:t,onOpenChange:s,action:n,currentStatus:l,onSave:i}=e,[o,c]=(0,r.useState)(l),[d,u]=(0,r.useState)(n.start_date||""),[x,h]=(0,r.useState)(n.completion_date||"");(0,r.useEffect)(()=>{c(l),u(n.start_date||""),h(n.completion_date||"")},[n,l]);let p="scheduled"===o||"in_progress"===o||"completed"===o;return(0,a.jsx)(N,{open:t,onOpenChange:s,children:(0,a.jsxs)(S,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(_,{children:"Update Action Status"}),(0,a.jsx)(I,{children:"Change the status and update relevant dates."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{className:"text-sm font-medium",children:"Action"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:n.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"status",children:"Status *"}),(0,a.jsxs)(E,{value:o,onValueChange:c,children:[(0,a.jsx)(T,{id:"status",children:(0,a.jsx)(L,{})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"recommendation",children:"Recommendation"}),(0,a.jsx)(P,{value:"rejected",children:"Rejected"}),(0,a.jsx)(P,{value:"created",children:"Created"}),(0,a.jsx)(P,{value:"scheduled",children:"Scheduled"}),(0,a.jsx)(P,{value:"in_progress",children:"In Progress"}),(0,a.jsx)(P,{value:"completed",children:"Completed"})]})]})]}),p&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)($,{htmlFor:"start-date",children:["Start Date ",p&&"*"]}),(0,a.jsx)(ep,{id:"start-date",type:"date",value:d,onChange:e=>u(e.target.value),placeholder:"Select start date",required:p})]}),"completed"===o&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"completion-date",children:"Completion Date *"}),(0,a.jsx)(ep,{id:"completion-date",type:"date",value:x,onChange:e=>h(e.target.value),placeholder:"Select completion date",required:!0})]})]}),(0,a.jsxs)(A,{children:[(0,a.jsx)(m,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,a.jsx)(m,{onClick:()=>{let e,t="open";"recommendation"===o?t="open":"rejected"===o?t="rejected":(t="accepted",e=o),i(n.id,t,e,d||void 0,x||void 0),s(!1)},children:"Save Changes"})]})]})})}function tG(e){let{open:t,onOpenChange:s,types:n,onSave:l}=e,[i,o]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[u,x]=(0,r.useState)("medium");return(0,a.jsx)(N,{open:t,onOpenChange:s,children:(0,a.jsxs)(S,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(_,{children:"Create New Action"}),(0,a.jsx)(I,{children:"Add a new user-created action to your supply chain management."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"action-name",children:"Action Name *"}),(0,a.jsx)(W,{id:"action-name",value:i,onChange:e=>o(e.target.value),placeholder:"e.g., Order additional inventory for Product X",rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"action-type",children:"Action Type *"}),(0,a.jsxs)(E,{value:c,onValueChange:d,children:[(0,a.jsx)(T,{id:"action-type",children:(0,a.jsx)(L,{placeholder:"Select action type"})}),(0,a.jsx)(U,{children:n.map(e=>(0,a.jsx)(P,{value:e,children:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)($,{htmlFor:"severity",children:"Severity *"}),(0,a.jsxs)(E,{value:u,onValueChange:x,children:[(0,a.jsx)(T,{id:"severity",children:(0,a.jsx)(L,{})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"critical",children:"Critical"}),(0,a.jsx)(P,{value:"high",children:"High"}),(0,a.jsx)(P,{value:"medium",children:"Medium"}),(0,a.jsx)(P,{value:"low",children:"Low"})]})]})]})]}),(0,a.jsxs)(A,{children:[(0,a.jsx)(m,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,a.jsx)(m,{onClick:()=>{i&&c&&(l(i,c,u),o(""),d(""),x("medium"),s(!1))},disabled:!i||!c,children:"Create Action"})]})]})})}function tJ(){let{recommendations:e,recommendationMappings:t,loading:s,updateRecommendation:n}=eG(),[l,i]=(0,r.useState)("recommendations"),[o,d]=(0,r.useState)("all"),[u,x]=(0,r.useState)("all"),[h,p]=(0,r.useState)(null),[f,g]=(0,r.useState)(!1),j=(0,r.useMemo)(()=>{let e=new Map;return t.forEach(t=>{e.set(t.recommendation_id,t.display_name)}),e},[t]),v=(0,r.useMemo)(()=>"recommendations"===l?e.filter(e=>"open"===e.status||"rejected"===e.status):e.filter(e=>"accepted"===e.status||"user_created_action"===e.source&&"open"!==e.status),[e,l]),N=(0,r.useMemo)(()=>{let e=v;return"all"!==o&&(e=e.filter(e=>e.severity===o)),"all"!==u&&(e=e.filter(e=>e.type===u)),e},[v,o,u]),b=(0,r.useMemo)(()=>Array.from(new Set(e.map(e=>e.type))).sort(),[e]),w=e=>{switch(e){case"rejected":return"bg-red-100 text-red-800 dark:bg-red-950 dark:text-red-300";case"created":default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300";case"scheduled":return"bg-blue-100 text-blue-800 dark:bg-blue-950 dark:text-blue-300";case"in_progress":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-950 dark:text-yellow-300";case"completed":return"bg-green-100 text-green-800 dark:bg-green-950 dark:text-green-300"}},k=e=>{let t=j.get(e);return t||e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},S=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null,C=e=>{let t;t="rejected"===e.status?"rejected":"open"===e.status?"recommendation":e.action_status?e.action_status:"created",p({action:e,currentStatus:t})};return s?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading recommendations..."})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-8 border-b",children:[(0,a.jsx)("button",{onClick:()=>i("recommendations"),className:c("pb-3 text-lg font-semibold transition-colors relative","recommendations"===l?"text-foreground after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-primary":"text-muted-foreground hover:text-foreground"),children:"Recommendations"}),(0,a.jsx)("button",{onClick:()=>i("actions"),className:c("pb-3 text-lg font-semibold transition-colors relative","actions"===l?"text-foreground after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-primary":"text-muted-foreground hover:text-foreground"),children:"Actions"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(E,{value:o,onValueChange:d,children:[(0,a.jsx)(T,{className:"w-[180px]",children:(0,a.jsx)(L,{placeholder:"All Severity"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"all",children:"All Severity"}),(0,a.jsx)(P,{value:"critical",children:"Critical"}),(0,a.jsx)(P,{value:"high",children:"High"}),(0,a.jsx)(P,{value:"medium",children:"Medium"}),(0,a.jsx)(P,{value:"low",children:"Low"})]})]}),(0,a.jsxs)(E,{value:u,onValueChange:x,children:[(0,a.jsx)(T,{className:"w-[180px]",children:(0,a.jsx)(L,{placeholder:"All Themes"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(P,{value:"all",children:"All Themes"}),b.map(e=>(0,a.jsx)(P,{value:e,children:k(e)},e))]})]}),"actions"===l&&(0,a.jsxs)(m,{onClick:()=>g(!0),size:"sm",className:"ml-auto gap-2",children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),"Add New Action"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:0===N.length?(0,a.jsxs)("div",{className:"text-sm text-muted-foreground text-center py-8",children:["No ","recommendations"===l?"recommendations":"actions"," available"]}):N.map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-4 p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,a.jsx)("div",{className:c("p-2 rounded-lg shrink-0",(e=>{switch(e){case"critical":case"high":return"bg-red-100 text-red-600 dark:bg-red-950 dark:text-red-400";case"medium":return"bg-yellow-100 text-yellow-600 dark:bg-yellow-950 dark:text-yellow-400";case"low":return"bg-blue-100 text-blue-600 dark:bg-blue-950 dark:text-blue-400";default:return"bg-muted text-muted-foreground"}})(e.severity)),children:(0,a.jsx)(tx.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)(X,{className:c("text-xs font-medium",e.type.includes("inventory")?"bg-red-600 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200"),children:k(e.type)}),(0,a.jsx)(X,{className:c("text-xs font-medium",(e=>{switch(e){case"critical":case"high":return"bg-red-600 text-white hover:bg-red-700";case"medium":return"bg-blue-600 text-white hover:bg-blue-700";case"low":return"bg-gray-600 text-white hover:bg-gray-700";default:return"bg-muted text-muted-foreground"}})(e.severity)),children:e.severity}),"recommendation"===e.source&&(0,a.jsx)(Q.A,{className:"h-4 w-4 text-blue-600"}),"user_created_action"===e.source&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,a.jsx)(el.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"User Created"})]}),"recommendations"===l&&"rejected"===e.status&&(0,a.jsx)(X,{className:c("text-xs font-medium cursor-pointer hover:opacity-80 transition-opacity",w("rejected")),onClick:()=>C(e),children:"rejected"}),"actions"===l&&e.action_status&&(0,a.jsx)(X,{className:c("text-xs font-medium cursor-pointer hover:opacity-80 transition-opacity",w(e.action_status)),onClick:()=>C(e),children:e.action_status.replace("_"," ")})]}),(0,a.jsx)("p",{className:"text-sm font-medium leading-tight",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.created_date&&(0,a.jsxs)("span",{children:["Created: ",S(e.created_date)]}),"actions"===l&&e.start_date&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(tY.A,{className:"h-3 w-3"}),"Start: ",S(e.start_date)]}),"actions"===l&&e.completion_date&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(D.A,{className:"h-3 w-3"}),"Completed: ",S(e.completion_date)]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 shrink-0",children:"recommendations"===l&&"rejected"!==e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>{n({...e,status:"accepted",action_status:"scheduled",start_date:new Date().toISOString().split("T")[0]})},className:"gap-1",children:[(0,a.jsx)(D.A,{className:"h-4 w-4"}),"Accept"]}),(0,a.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>{n({...e,status:"rejected"})},className:"gap-1",children:[(0,a.jsx)(y.A,{className:"h-4 w-4"}),"Reject"]})]})})]},e.id))}),h&&(0,a.jsx)(t$,{open:!!h,onOpenChange:e=>!e&&p(null),action:h.action,currentStatus:h.currentStatus,onSave:(t,s,a,r,l)=>{let i=e.find(e=>e.id===t);i&&n({...i,status:s,action_status:a,start_date:r,completion_date:l})}}),(0,a.jsx)(tG,{open:f,onOpenChange:g,types:b,onSave:(e,t,s)=>{n({id:"ACT-".concat(Date.now()),source:"user_created_action",name:e,type:t,severity:s,status:"created",action_status:"created",created_date:new Date().toISOString().split("T")[0]})}})]})}function tQ(){let[e,t]=(0,r.useState)("chart"),[s,n]=(0,r.useState)({product:"All Products",location:"All Locations",timeRange:"20w"}),[l,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null);return(0,a.jsx)(e$,{children:(0,a.jsx)(ex,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)(e0,{}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[(0,a.jsx)(tf,{selectedSegment:l,filters:s,setFilters:n}),(0,a.jsx)(tq,{viewMode:e,setViewMode:t,filters:s,setFilters:n,selectedSegment:l,setSelectedSegment:i,onSegmentDetails:e=>{m(e),c(!0)}}),(0,a.jsx)(tJ,{})]}),(0,a.jsx)(tZ,{}),(0,a.jsx)(tP,{open:o,onOpenChange:c,segment:d,totalItems:0})]})})})}},83631:(e,t,s)=>{Promise.resolve().then(s.bind(s,30868))}},e=>{e.O(0,[303,441,255,358],()=>e(e.s=83631)),_N_E=e.O()}]);